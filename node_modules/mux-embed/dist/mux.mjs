var Jr=Object.create;var lt=Object.defineProperty;var Qr=Object.getOwnPropertyDescriptor;var zr=Object.getOwnPropertyNames;var Kr=Object.getPrototypeOf,Yr=Object.prototype.hasOwnProperty;var ct=function(r,e){return function(){return r&&(e=r(r=0)),e}};var H=function(r,e){return function(){return e||r((e={exports:{}}).exports,e),e.exports}};var Xr=function(r,e,t,i){if(e&&typeof e=="object"||typeof e=="function")for(var a=zr(e),n=0,o=a.length,s;n<o;n++)s=a[n],!Yr.call(r,s)&&s!==t&&lt(r,s,{get:function(l){return e[l]}.bind(null,s),enumerable:!(i=Qr(e,s))||i.enumerable});return r};var W=function(r,e,t){return t=r!=null?Jr(Kr(r)):{},Xr(e||!r||!r.__esModule?lt(t,"default",{value:r,enumerable:!0}):t,r)};var G=H(function(Ui,vt){var ke;typeof window!="undefined"?ke=window:typeof global!="undefined"?ke=global:typeof self!="undefined"?ke=self:ke={};vt.exports=ke});function B(r,e){return e!=null&&typeof Symbol!="undefined"&&e[Symbol.hasInstance]?!!e[Symbol.hasInstance](r):B(r,e)}var ee=ct(function(){ee()});function le(r){"@swc/helpers - typeof";return r&&typeof Symbol!="undefined"&&r.constructor===Symbol?"symbol":typeof r}var Pe=ct(function(){});var ze=H(function(pu,fr){var _r=Array.prototype.slice;fr.exports=Wa;function Wa(r,e){for(("length"in r)||(r=[r]),r=_r.call(r);r.length;){var t=r.shift(),i=e(t);if(i)return i;t.childNodes&&t.childNodes.length&&(r=_r.call(t.childNodes).concat(r))}}});var vr=H(function(mu,pr){ee();pr.exports=ve;function ve(r,e){if(!B(this,ve))return new ve(r,e);this.data=r,this.nodeValue=r,this.length=r.length,this.ownerDocument=e||null}ve.prototype.nodeType=8;ve.prototype.nodeName="#comment";ve.prototype.toString=function(){return"[object Comment]"}});var hr=H(function(yu,mr){ee();mr.exports=ae;function ae(r,e){if(!B(this,ae))return new ae(r);this.data=r||"",this.length=this.data.length,this.ownerDocument=e||null}ae.prototype.type="DOMTextNode";ae.prototype.nodeType=3;ae.prototype.nodeName="#text";ae.prototype.toString=function(){return this.data};ae.prototype.replaceData=function(e,t,i){var a=this.data,n=a.substring(0,e),o=a.substring(e+t,a.length);this.data=n+i+o,this.length=this.data.length}});var Ke=H(function(gu,yr){yr.exports=Ga;function Ga(r){var e=this,t=r.type;r.target||(r.target=e),e.listeners||(e.listeners={});var i=e.listeners[t];if(i)return i.forEach(function(a){r.currentTarget=e,typeof a=="function"?a(r):a.handleEvent(r)});e.parentNode&&e.parentNode.dispatchEvent(r)}});var Ye=H(function(bu,gr){gr.exports=Ja;function Ja(r,e){var t=this;t.listeners||(t.listeners={}),t.listeners[r]||(t.listeners[r]=[]),t.listeners[r].indexOf(e)===-1&&t.listeners[r].push(e)}});var Xe=H(function(Tu,br){br.exports=Qa;function Qa(r,e){var t=this;if(t.listeners&&t.listeners[r]){var i=t.listeners[r],a=i.indexOf(e);a!==-1&&i.splice(a,1)}}});var kr=H(function(Eu,Er){Pe();Er.exports=Tr;var za=["area","base","br","col","embed","hr","img","input","keygen","link","menuitem","meta","param","source","track","wbr"];function Tr(r){switch(r.nodeType){case 3:return $e(r.data);case 8:return"<!--"+r.data+"-->";default:return Ka(r)}}function Ka(r){var e=[],t=r.tagName;return r.namespaceURI==="http://www.w3.org/1999/xhtml"&&(t=t.toLowerCase()),e.push("<"+t+Za(r)+$a(r)),za.indexOf(t)>-1?e.push(" />"):(e.push(">"),r.childNodes.length?e.push.apply(e,r.childNodes.map(Tr)):r.textContent||r.innerText?e.push($e(r.textContent||r.innerText)):r.innerHTML&&e.push(r.innerHTML),e.push("</"+t+">")),e.join("")}function Ya(r,e){var t=le(r[e]);return e==="style"&&Object.keys(r.style).length>0?!0:r.hasOwnProperty(e)&&(t==="string"||t==="boolean"||t==="number")&&e!=="nodeName"&&e!=="className"&&e!=="tagName"&&e!=="textContent"&&e!=="innerText"&&e!=="namespaceURI"&&e!=="innerHTML"}function Xa(r){if(typeof r=="string")return r;var e="";return Object.keys(r).forEach(function(t){var i=r[t];t=t.replace(/[A-Z]/g,function(a){return"-"+a.toLowerCase()}),e+=t+":"+i+";"}),e}function $a(r){var e=r.dataset,t=[];for(var i in e)t.push({name:"data-"+i,value:e[i]});return t.length?wr(t):""}function wr(r){var e=[];return r.forEach(function(t){var i=t.name,a=t.value;i==="style"&&(a=Xa(a)),e.push(i+'="'+ei(a)+'"')}),e.length?" "+e.join(" "):""}function Za(r){var e=[];for(var t in r)Ya(r,t)&&e.push({name:t,value:r[t]});for(var i in r._attributes)for(var a in r._attributes[i]){var n=r._attributes[i][a],o=(n.prefix?n.prefix+":":"")+a;e.push({name:o,value:n.value})}return r.className&&e.push({name:"class",value:r.className}),e.length?wr(e):""}function $e(r){var e="";return typeof r=="string"?e=r:r&&(e=r.toString()),e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function ei(r){return $e(r).replace(/"/g,"&quot;")}});var et=H(function(xu,Dr){ee();var Ze=ze(),ti=Ke(),ri=Ye(),ai=Xe(),ii=kr(),xr="http://www.w3.org/1999/xhtml";Dr.exports=N;function N(r,e,t){if(!B(this,N))return new N(r);var i=t===void 0?xr:t||null;this.tagName=i===xr?String(r).toUpperCase():r,this.nodeName=this.tagName,this.className="",this.dataset={},this.childNodes=[],this.parentNode=null,this.style={},this.ownerDocument=e||null,this.namespaceURI=i,this._attributes={},this.tagName==="INPUT"&&(this.type="text")}N.prototype.type="DOMElement";N.prototype.nodeType=1;N.prototype.appendChild=function(e){return e.parentNode&&e.parentNode.removeChild(e),this.childNodes.push(e),e.parentNode=this,e};N.prototype.replaceChild=function(e,t){e.parentNode&&e.parentNode.removeChild(e);var i=this.childNodes.indexOf(t);return t.parentNode=null,this.childNodes[i]=e,e.parentNode=this,t};N.prototype.removeChild=function(e){var t=this.childNodes.indexOf(e);return this.childNodes.splice(t,1),e.parentNode=null,e};N.prototype.insertBefore=function(e,t){e.parentNode&&e.parentNode.removeChild(e);var i=t==null?-1:this.childNodes.indexOf(t);return i>-1?this.childNodes.splice(i,0,e):this.childNodes.push(e),e.parentNode=this,e};N.prototype.setAttributeNS=function(e,t,i){var a=null,n=t,o=t.indexOf(":");if(o>-1&&(a=t.substr(0,o),n=t.substr(o+1)),this.tagName==="INPUT"&&t==="type")this.type=i;else{var s=this._attributes[e]||(this._attributes[e]={});s[n]={value:i,prefix:a}}};N.prototype.getAttributeNS=function(e,t){var i=this._attributes[e],a=i&&i[t]&&i[t].value;return this.tagName==="INPUT"&&t==="type"?this.type:typeof a!="string"?null:a};N.prototype.removeAttributeNS=function(e,t){var i=this._attributes[e];i&&delete i[t]};N.prototype.hasAttributeNS=function(e,t){var i=this._attributes[e];return!!i&&t in i};N.prototype.setAttribute=function(e,t){return this.setAttributeNS(null,e,t)};N.prototype.getAttribute=function(e){return this.getAttributeNS(null,e)};N.prototype.removeAttribute=function(e){return this.removeAttributeNS(null,e)};N.prototype.hasAttribute=function(e){return this.hasAttributeNS(null,e)};N.prototype.removeEventListener=ai;N.prototype.addEventListener=ri;N.prototype.dispatchEvent=ti;N.prototype.focus=function(){};N.prototype.toString=function(){return ii(this)};N.prototype.getElementsByClassName=function(e){var t=e.split(" "),i=[];return Ze(this,function(a){if(a.nodeType===1){var n=a.className||"",o=n.split(" ");t.every(function(s){return o.indexOf(s)!==-1})&&i.push(a)}}),i};N.prototype.getElementsByTagName=function(e){e=e.toLowerCase();var t=[];return Ze(this.childNodes,function(i){i.nodeType===1&&(e==="*"||i.tagName.toLowerCase()===e)&&t.push(i)}),t};N.prototype.contains=function(e){return Ze(this,function(t){return e===t})||!1}});var Rr=H(function(Su,Sr){ee();var tt=et();Sr.exports=z;function z(r){if(!B(this,z))return new z;this.childNodes=[],this.parentNode=null,this.ownerDocument=r||null}z.prototype.type="DocumentFragment";z.prototype.nodeType=11;z.prototype.nodeName="#document-fragment";z.prototype.appendChild=tt.prototype.appendChild;z.prototype.replaceChild=tt.prototype.replaceChild;z.prototype.removeChild=tt.prototype.removeChild;z.prototype.toString=function(){return this.childNodes.map(function(e){return String(e)}).join("")}});var Ar=H(function(Ru,qr){qr.exports=rt;function rt(r){}rt.prototype.initEvent=function(e,t,i){this.type=e,this.bubbles=t,this.cancelable=i};rt.prototype.preventDefault=function(){}});var Ir=H(function(Au,Or){ee();var ni=ze(),oi=vr(),si=hr(),Re=et(),ui=Rr(),di=Ar(),li=Ke(),ci=Ye(),_i=Xe();Or.exports=Ue;function Ue(){if(!B(this,Ue))return new Ue;this.head=this.createElement("head"),this.body=this.createElement("body"),this.documentElement=this.createElement("html"),this.documentElement.appendChild(this.head),this.documentElement.appendChild(this.body),this.childNodes=[this.documentElement],this.nodeType=9}var V=Ue.prototype;V.createTextNode=function(e){return new si(e,this)};V.createElementNS=function(e,t){var i=e===null?null:String(e);return new Re(t,this,i)};V.createElement=function(e){return new Re(e,this)};V.createDocumentFragment=function(){return new ui(this)};V.createEvent=function(e){return new di(e)};V.createComment=function(e){return new oi(e,this)};V.getElementById=function(e){e=String(e);var t=ni(this.childNodes,function(i){if(String(i.id)===e)return i});return t||null};V.getElementsByClassName=Re.prototype.getElementsByClassName;V.getElementsByTagName=Re.prototype.getElementsByTagName;V.contains=Re.prototype.contains;V.removeEventListener=_i;V.addEventListener=ci;V.dispatchEvent=li});var Pr=H(function(Ou,Nr){var fi=Ir();Nr.exports=new fi});var Mr=H(function(Iu,Cr){var Lr=typeof global!="undefined"?global:typeof window!="undefined"?window:{},pi=Pr(),qe;typeof document!="undefined"?qe=document:(qe=Lr["__GLOBAL_DOCUMENT_CACHE@4"],qe||(qe=Lr["__GLOBAL_DOCUMENT_CACHE@4"]=pi));Cr.exports=qe});function _t(r){if(Array.isArray(r))return r}function ft(r,e){var t=r==null?null:typeof Symbol!="undefined"&&r[Symbol.iterator]||r["@@iterator"];if(t!=null){var i=[],a=!0,n=!1,o,s;try{for(t=t.call(r);!(a=(o=t.next()).done)&&(i.push(o.value),!(e&&i.length===e));a=!0);}catch(l){n=!0,s=l}finally{try{!a&&t.return!=null&&t.return()}finally{if(n)throw s}}return i}}function pt(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Ee(r,e){(e==null||e>r.length)&&(e=r.length);for(var t=0,i=new Array(e);t<e;t++)i[t]=r[t];return i}function Ae(r,e){if(r){if(typeof r=="string")return Ee(r,e);var t=Object.prototype.toString.call(r).slice(8,-1);if(t==="Object"&&r.constructor&&(t=r.constructor.name),t==="Map"||t==="Set")return Array.from(t);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return Ee(r,e)}}function M(r,e){return _t(r)||ft(r,e)||Ae(r,e)||pt()}var ge=W(G());var Z=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=Math.random()*16|0,i=e==="x"?t:t&3|8;return i.toString(16)})},Oe=function(){return("000000"+(Math.random()*Math.pow(36,6)<<0).toString(36)).slice(-6)};var K=function(e){if(e&&typeof e.nodeName!="undefined")return e.muxId||(e.muxId=Oe()),e.muxId;var t;try{t=document.querySelector(e)}catch(i){}return t&&!t.muxId&&(t.muxId=e),(t==null?void 0:t.muxId)||e},xe=function(e){var t;e&&typeof e.nodeName!="undefined"?(t=e,e=K(t)):t=document.querySelector(e);var i=t&&t.nodeName?t.nodeName.toLowerCase():"";return[t,e,i]};function mt(r){if(Array.isArray(r))return Ee(r)}function ht(r){if(typeof Symbol!="undefined"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function yt(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function J(r){return mt(r)||ht(r)||Ae(r)||yt()}var Y={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},gt=function(r){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:3,t,i,a,n,o,s=r?[console,r]:[console],l=(t=console.trace).bind.apply(t,J(s)),v=(i=console.info).bind.apply(i,J(s)),T=(a=console.debug).bind.apply(a,J(s)),b=(n=console.warn).bind.apply(n,J(s)),m=(o=console.error).bind.apply(o,J(s)),_=e;return{trace:function(){for(var k=arguments.length,x=new Array(k),p=0;p<k;p++)x[p]=arguments[p];if(!(_>Y.TRACE))return l.apply(void 0,J(x))},debug:function(){for(var k=arguments.length,x=new Array(k),p=0;p<k;p++)x[p]=arguments[p];if(!(_>Y.DEBUG))return T.apply(void 0,J(x))},info:function(){for(var k=arguments.length,x=new Array(k),p=0;p<k;p++)x[p]=arguments[p];if(!(_>Y.INFO))return v.apply(void 0,J(x))},warn:function(){for(var k=arguments.length,x=new Array(k),p=0;p<k;p++)x[p]=arguments[p];if(!(_>Y.WARN))return b.apply(void 0,J(x))},error:function(){for(var k=arguments.length,x=new Array(k),p=0;p<k;p++)x[p]=arguments[p];if(!(_>Y.ERROR))return m.apply(void 0,J(x))},get level(){return _},set level(h){h!==this.level&&(_=h!=null?h:e)}}};var q=gt("[mux]");var Ie=W(G());function de(){var r=Ie.default.doNotTrack||Ie.default.navigator&&Ie.default.navigator.doNotTrack;return r==="1"}var bt=W(G()),$r={now:function(){var r=bt.default.performance,e=r&&r.timing,t=e&&e.navigationStart,i=typeof t=="number"&&typeof r.now=="function"?t+r.now():Date.now();return Math.round(i)}},A=$r;function g(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}ee();function D(r,e){if(!B(r,e))throw new TypeError("Cannot call a class as a function")}function Tt(r,e){for(var t=0;t<e.length;t++){var i=e[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(r,i.key,i)}}function L(r,e,t){return e&&Tt(r.prototype,e),t&&Tt(r,t),r}function u(r,e,t){return e in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function Ne(r,e){return Ne=Object.setPrototypeOf||function(i,a){return i.__proto__=a,i},Ne(r,e)}function wt(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(e&&e.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),e&&Ne(r,e)}function De(r){return De=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},De(r)}function Et(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(r){return!1}}Pe();function kt(r,e){return e&&(le(e)==="object"||typeof e=="function")?e:g(r)}function xt(r){var e=Et();return function(){var i=De(r),a;if(e){var n=De(this).constructor;a=Reflect.construct(i,arguments,n)}else a=i.apply(this,arguments);return kt(this,a)}}var U=function(r){return te(r)[0]};var te=function(r){if(typeof r!="string"||r==="")return["localhost"];var e=/^(([^:\/?#]+):)?(\/\/([^\/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?/,t=r.match(e)||[],i=t[4],a;return i&&(a=(i.match(/[^\.]+\.[^\.]+$/)||[])[0]),[i,a]};var Le=W(G()),Zr={exists:function(){var r=Le.default.performance,e=r&&r.timing;return e!==void 0},domContentLoadedEventEnd:function(){var r=Le.default.performance,e=r&&r.timing;return e&&e.domContentLoadedEventEnd},navigationStart:function(){var r=Le.default.performance,e=r&&r.timing;return e&&e.navigationStart}},ce=Zr;function O(r,e,t){t=t===void 0?1:t,r[e]=r[e]||0,r[e]+=t}function oe(r){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{},i=Object.keys(t);typeof Object.getOwnPropertySymbols=="function"&&(i=i.concat(Object.getOwnPropertySymbols(t).filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable}))),i.forEach(function(a){u(r,a,t[a])})}return r}function ea(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(r);e&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(r,a).enumerable})),t.push.apply(t,i)}return t}function _e(r,e){return e=e!=null?e:{},Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(e)):ea(Object(e)).forEach(function(t){Object.defineProperty(r,t,Object.getOwnPropertyDescriptor(e,t))}),r}var ta=["x-cdn","content-type"],Dt=["x-request-id","cf-ray","x-amz-cf-id","x-akamai-request-id"],ra=ta.concat(Dt);function fe(r){r=r||"";var e={},t=r.trim().split(/[\r\n]+/);return t.forEach(function(i){if(i){var a=i.split(": "),n=a.shift();n&&(ra.indexOf(n.toLowerCase())>=0||n.toLowerCase().indexOf("x-litix-")===0)&&(e[n]=a.join(": "))}}),e}function se(r){if(r){var e=Dt.find(function(t){return r[t]!==void 0});return e?r[e]:void 0}}var aa=function(r){var e={};for(var t in r){var i=r[t],a=i["DATA-ID"].search("io.litix.data.");if(a!==-1){var n=i["DATA-ID"].replace("io.litix.data.","");e[n]=i.VALUE}}return e},Ce=aa;var Me=function(r){if(!r)return{};var e=ce.navigationStart(),t=r.loading,i=t?t.start:r.trequest,a=t?t.first:r.tfirst,n=t?t.end:r.tload;return{bytesLoaded:r.total,requestStart:Math.round(e+i),responseStart:Math.round(e+a),responseEnd:Math.round(e+n)}},Se=function(r){if(!(!r||typeof r.getAllResponseHeaders!="function"))return fe(r.getAllResponseHeaders())},St=function(r,e,t){var i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},a=arguments.length>4?arguments[4]:void 0,n=r.log,o=r.utils.secondsToMs,s=function(p){var f=parseInt(a.version),c;return f===1&&p.programDateTime!==null&&(c=p.programDateTime),f===0&&p.pdt!==null&&(c=p.pdt),c};if(!ce.exists()){n.warn("performance timing not supported. Not tracking HLS.js.");return}var l=function(p,f){return r.emit(e,p,f)},v=function(p,f){var c=f.levels,d=f.audioTracks,y=f.url,w=f.stats,E=f.networkDetails,S=f.sessionData,P={},C={};c.forEach(function(j,ne){P[ne]={width:j.width,height:j.height,bitrate:j.bitrate,attrs:j.attrs}}),d.forEach(function(j,ne){C[ne]={name:j.name,language:j.lang,bitrate:j.bitrate}});var I=Me(w),R=I.bytesLoaded,$=I.requestStart,be=I.responseStart,Te=I.responseEnd;l("requestcompleted",_e(oe({},Ce(S)),{request_event_type:p,request_bytes_loaded:R,request_start:$,request_response_start:be,request_response_end:Te,request_type:"manifest",request_hostname:U(y),request_response_headers:Se(E),request_rendition_lists:{media:P,audio:C,video:{}}}))};t.on(a.Events.MANIFEST_LOADED,v);var T=function(p,f){var c=f.details,d=f.level,y=f.networkDetails,w=f.stats,E=Me(w),S=E.bytesLoaded,P=E.requestStart,C=E.responseStart,I=E.responseEnd,R=c.fragments[c.fragments.length-1],$=s(R)+o(R.duration);l("requestcompleted",{request_event_type:p,request_bytes_loaded:S,request_start:P,request_response_start:C,request_response_end:I,request_current_level:d,request_type:"manifest",request_hostname:U(c.url),request_response_headers:Se(y),video_holdback:c.holdBack&&o(c.holdBack),video_part_holdback:c.partHoldBack&&o(c.partHoldBack),video_part_target_duration:c.partTarget&&o(c.partTarget),video_target_duration:c.targetduration&&o(c.targetduration),video_source_is_live:c.live,player_manifest_newest_program_time:isNaN($)?void 0:$})};t.on(a.Events.LEVEL_LOADED,T);var b=function(p,f){var c=f.details,d=f.networkDetails,y=f.stats,w=Me(y),E=w.bytesLoaded,S=w.requestStart,P=w.responseStart,C=w.responseEnd;l("requestcompleted",{request_event_type:p,request_bytes_loaded:E,request_start:S,request_response_start:P,request_response_end:C,request_type:"manifest",request_hostname:U(c.url),request_response_headers:Se(d)})};t.on(a.Events.AUDIO_TRACK_LOADED,b);var m=function(p,f){var c=f.stats,d=f.networkDetails,y=f.frag;c=c||y.stats;var w=Me(c),E=w.bytesLoaded,S=w.requestStart,P=w.responseStart,C=w.responseEnd,I=d?Se(d):void 0,R={request_event_type:p,request_bytes_loaded:E,request_start:S,request_response_start:P,request_response_end:C,request_hostname:d?U(d.responseURL):void 0,request_id:I?se(I):void 0,request_response_headers:I,request_media_duration:y.duration,request_url:d==null?void 0:d.responseURL};y.type==="main"?(R.request_type="media",R.request_current_level=y.level,R.request_video_width=(t.levels[y.level]||{}).width,R.request_video_height=(t.levels[y.level]||{}).height,R.request_labeled_bitrate=(t.levels[y.level]||{}).bitrate):R.request_type=y.type,l("requestcompleted",R)};t.on(a.Events.FRAG_LOADED,m);var _=function(p,f){var c=f.frag,d=c.start,y=s(c),w={currentFragmentPDT:y,currentFragmentStart:o(d)};l("fragmentchange",w)};t.on(a.Events.FRAG_CHANGED,_);var h=function(p,f){var c=f.type,d=f.details,y=f.response,w=f.fatal,E=f.frag,S=f.networkDetails,P=(E==null?void 0:E.url)||f.url||"",C=S?Se(S):void 0;if((d===a.ErrorDetails.MANIFEST_LOAD_ERROR||d===a.ErrorDetails.MANIFEST_LOAD_TIMEOUT||d===a.ErrorDetails.FRAG_LOAD_ERROR||d===a.ErrorDetails.FRAG_LOAD_TIMEOUT||d===a.ErrorDetails.LEVEL_LOAD_ERROR||d===a.ErrorDetails.LEVEL_LOAD_TIMEOUT||d===a.ErrorDetails.AUDIO_TRACK_LOAD_ERROR||d===a.ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT||d===a.ErrorDetails.SUBTITLE_LOAD_ERROR||d===a.ErrorDetails.SUBTITLE_LOAD_TIMEOUT||d===a.ErrorDetails.KEY_LOAD_ERROR||d===a.ErrorDetails.KEY_LOAD_TIMEOUT)&&l("requestfailed",{request_error:d,request_url:P,request_hostname:U(P),request_id:C?se(C):void 0,request_type:d===a.ErrorDetails.FRAG_LOAD_ERROR||d===a.ErrorDetails.FRAG_LOAD_TIMEOUT?"media":d===a.ErrorDetails.AUDIO_TRACK_LOAD_ERROR||d===a.ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT?"audio":d===a.ErrorDetails.SUBTITLE_LOAD_ERROR||d===a.ErrorDetails.SUBTITLE_LOAD_TIMEOUT?"subtitle":d===a.ErrorDetails.KEY_LOAD_ERROR||d===a.ErrorDetails.KEY_LOAD_TIMEOUT?"encryption":"manifest",request_error_code:y==null?void 0:y.code,request_error_text:y==null?void 0:y.text}),w){var I,R="".concat(P?"url: ".concat(P,"\n"):"")+"".concat(y&&(y.code||y.text)?"response: ".concat(y.code,", ").concat(y.text,"\n"):"")+"".concat(f.reason?"failure reason: ".concat(f.reason,"\n"):"")+"".concat(f.level?"level: ".concat(f.level,"\n"):"")+"".concat(f.parent?"parent stream controller: ".concat(f.parent,"\n"):"")+"".concat(f.buffer?"buffer length: ".concat(f.buffer,"\n"):"")+"".concat(f.error?"error: ".concat(f.error,"\n"):"")+"".concat(f.event?"event: ".concat(f.event,"\n"):"")+"".concat(f.err?"error message: ".concat((I=f.err)===null||I===void 0?void 0:I.message,"\n"):"");l("error",{player_error_code:c,player_error_message:d,player_error_context:R})}};t.on(a.Events.ERROR,h);var k=function(p,f){var c=f.frag,d=c&&c._url||"";l("requestcanceled",{request_event_type:p,request_url:d,request_type:"media",request_hostname:U(d)})};t.on(a.Events.FRAG_LOAD_EMERGENCY_ABORTED,k);var x=function(p,f){var c=f.level,d=t.levels[c];if(d&&d.attrs&&d.attrs.BANDWIDTH){var y=d.attrs.BANDWIDTH,w,E=parseFloat(d.attrs["FRAME-RATE"]);isNaN(E)||(w=E),y?l("renditionchange",{video_source_fps:w,video_source_bitrate:y,video_source_width:d.width,video_source_height:d.height,video_source_rendition_name:d.name,video_source_codec:d==null?void 0:d.videoCodec}):n.warn("missing BANDWIDTH from HLS manifest parsed by HLS.js")}};t.on(a.Events.LEVEL_SWITCHED,x),t._stopMuxMonitor=function(){t.off(a.Events.MANIFEST_LOADED,v),t.off(a.Events.LEVEL_LOADED,T),t.off(a.Events.AUDIO_TRACK_LOADED,b),t.off(a.Events.FRAG_LOADED,m),t.off(a.Events.FRAG_CHANGED,_),t.off(a.Events.ERROR,h),t.off(a.Events.FRAG_LOAD_EMERGENCY_ABORTED,k),t.off(a.Events.LEVEL_SWITCHED,x),t.off(a.Events.DESTROYING,t._stopMuxMonitor),delete t._stopMuxMonitor},t.on(a.Events.DESTROYING,t._stopMuxMonitor)},Rt=function(r){r&&typeof r._stopMuxMonitor=="function"&&r._stopMuxMonitor()};var qt=function(r,e){if(!r||!r.requestEndDate)return{};var t=U(r.url),i=r.url,a=r.bytesLoaded,n=new Date(r.requestStartDate).getTime(),o=new Date(r.firstByteDate).getTime(),s=new Date(r.requestEndDate).getTime(),l=isNaN(r.duration)?0:r.duration,v=typeof e.getMetricsFor=="function"?e.getMetricsFor(r.mediaType).HttpList:e.getDashMetrics().getHttpRequests(r.mediaType),T;v.length>0&&(T=fe(v[v.length-1]._responseHeaders||""));var b=T?se(T):void 0;return{requestStart:n,requestResponseStart:o,requestResponseEnd:s,requestBytesLoaded:a,requestResponseHeaders:T,requestMediaDuration:l,requestHostname:t,requestUrl:i,requestId:b}},ia=function(r,e){var t=e.getQualityFor(r),i=e.getCurrentTrackFor(r).bitrateList;return i?{currentLevel:t,renditionWidth:i[t].width||null,renditionHeight:i[t].height||null,renditionBitrate:i[t].bandwidth}:{}},na=function(r){var e;return(e=r.match(/.*codecs\*?="(.*)"/))===null||e===void 0?void 0:e[1]},oa=function(e){try{var t,i,a=(i=e.getVersion)===null||i===void 0||(t=i.call(e))===null||t===void 0?void 0:t.split(".").map(function(n){return parseInt(n)})[0];return a}catch(n){return!1}},At=function(r,e,t){var i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},a=r.log;if(!t||!t.on){a.warn("Invalid dash.js player reference. Monitoring blocked.");return}var n=oa(t),o=function(c,d){return r.emit(e,c,d)},s=function(c){var d=c.type,y=c.data,w=(y||{}).url;o("requestcompleted",{request_event_type:d,request_start:0,request_response_start:0,request_response_end:0,request_bytes_loaded:-1,request_type:"manifest",request_hostname:U(w),request_url:w})};t.on("manifestLoaded",s);var l={},v=function(c){if(typeof c.getRequests!="function")return null;var d=c.getRequests({state:"executed"});return d.length===0?null:d[d.length-1]},T=function(c){var d=c.type,y=c.fragmentModel,w=c.chunk,E=v(y);b({type:d,request:E,chunk:w})},b=function(c){var d=c.type,y=c.chunk,w=c.request,E=(y||{}).mediaInfo,S=E||{},P=S.type,C=S.bitrateList;C=C||[];var I={};C.forEach(function(we,Q){I[Q]={},I[Q].width=we.width,I[Q].height=we.height,I[Q].bitrate=we.bandwidth,I[Q].attrs={}}),P==="video"?l.video=I:P==="audio"?l.audio=I:l.media=I;var R=qt(w,t),$=R.requestStart,be=R.requestResponseStart,Te=R.requestResponseEnd,j=R.requestResponseHeaders,ne=R.requestMediaDuration,Ve=R.requestHostname,je=R.requestUrl,We=R.requestId;o("requestcompleted",{request_event_type:d,request_start:$,request_response_start:be,request_response_end:Te,request_bytes_loaded:-1,request_type:P+"_init",request_response_headers:j,request_hostname:Ve,request_id:We,request_url:je,request_media_duration:ne,request_rendition_lists:l})};n>=4?t.on("initFragmentLoaded",b):t.on("initFragmentLoaded",T);var m=function(c){var d=c.type,y=c.fragmentModel,w=c.chunk,E=v(y);_({type:d,request:E,chunk:w})},_=function(c){var d=c.type,y=c.chunk,w=c.request,E=y||{},S=E.mediaInfo,P=E.start,C=S||{},I=C.type,R=qt(w,t),$=R.requestStart,be=R.requestResponseStart,Te=R.requestResponseEnd,j=R.requestBytesLoaded,ne=R.requestResponseHeaders,Ve=R.requestMediaDuration,je=R.requestHostname,We=R.requestUrl,we=R.requestId,Q=ia(I,t),Vr=Q.currentLevel,jr=Q.renditionWidth,Wr=Q.renditionHeight,Gr=Q.renditionBitrate;o("requestcompleted",{request_event_type:d,request_start:$,request_response_start:be,request_response_end:Te,request_bytes_loaded:j,request_type:I,request_response_headers:ne,request_hostname:je,request_id:we,request_url:We,request_media_start_time:P,request_media_duration:Ve,request_current_level:Vr,request_labeled_bitrate:Gr,request_video_width:jr,request_video_height:Wr})};n>=4?t.on("mediaFragmentLoaded",_):t.on("mediaFragmentLoaded",m);var h={video:void 0,audio:void 0,totalBitrate:void 0},k=function(){if(h.video&&typeof h.video.bitrate=="number"){if(!(h.video.width&&h.video.height)){a.warn("have bitrate info for video but missing width/height");return}var c=h.video.bitrate;if(h.audio&&typeof h.audio.bitrate=="number"&&(c+=h.audio.bitrate),c!==h.totalBitrate)return h.totalBitrate=c,{video_source_bitrate:c,video_source_height:h.video.height,video_source_width:h.video.width,video_source_codec:na(h.video.codec)}}},x=function(c,d,y){if(typeof c.newQuality!="number"){a.warn("missing evt.newQuality in qualityChangeRendered event",c);return}var w=c.mediaType;if(w==="audio"||w==="video"){var E=t.getBitrateInfoListFor(w).find(function(P){var C=P.qualityIndex;return C===c.newQuality});if(!(E&&typeof E.bitrate=="number")){a.warn("missing bitrate info for ".concat(w));return}h[w]=_e(oe({},E),{codec:t.getCurrentTrackFor(w).codec});var S=k();S&&o("renditionchange",S)}};t.on("qualityChangeRendered",x);var p=function(c){var d=c.request,y=c.mediaType;d=d||{},o("requestcanceled",{request_event_type:d.type+"_"+d.action,request_url:d.url,request_type:y,request_hostname:U(d.url)})};t.on("fragmentLoadingAbandoned",p);var f=function(c){var d=c.error,y,w,E=(d==null||(y=d.data)===null||y===void 0?void 0:y.request)||{},S=(d==null||(w=d.data)===null||w===void 0?void 0:w.response)||{};(d==null?void 0:d.code)===27&&o("requestfailed",{request_error:E.type+"_"+E.action,request_url:E.url,request_hostname:U(E.url),request_type:E.mediaType,request_error_code:S.status,request_error_text:S.statusText});var P="".concat(E!=null&&E.url?"url: ".concat(E.url,"\n"):"")+"".concat(S!=null&&S.status||S!=null&&S.statusText?"response: ".concat(S==null?void 0:S.status,", ").concat(S==null?void 0:S.statusText,"\n"):"");o("error",{player_error_code:d==null?void 0:d.code,player_error_message:d==null?void 0:d.message,player_error_context:P})};t.on("error",f),t._stopMuxMonitor=function(){t.off("manifestLoaded",s),t.off("initFragmentLoaded",b),t.off("mediaFragmentLoaded",_),t.off("qualityChangeRendered",x),t.off("error",f),t.off("fragmentLoadingAbandoned",p),delete t._stopMuxMonitor}},Ot=function(r){r&&typeof r._stopMuxMonitor=="function"&&r._stopMuxMonitor()};var It=0,sa=function(){"use strict";function r(){D(this,r),u(this,"_listeners",void 0)}return L(r,[{key:"on",value:function(t,i,a){return i._eventEmitterGuid=i._eventEmitterGuid||++It,this._listeners=this._listeners||{},this._listeners[t]=this._listeners[t]||[],a&&(i=i.bind(a)),this._listeners[t].push(i),i}},{key:"off",value:function(t,i){var a=this._listeners&&this._listeners[t];a&&a.forEach(function(n,o){n._eventEmitterGuid===i._eventEmitterGuid&&a.splice(o,1)})}},{key:"one",value:function(t,i,a){var n=this;i._eventEmitterGuid=i._eventEmitterGuid||++It;var o=function(){n.off(t,o),i.apply(a||this,arguments)};o._eventEmitterGuid=i._eventEmitterGuid,this.on(t,o)}},{key:"emit",value:function(t,i){var a=this;if(this._listeners){i=i||{};var n=this._listeners["before*"]||[],o=this._listeners[t]||[],s=this._listeners["after"+t]||[],l=function(v,T){v=v.slice(),v.forEach(function(b){b.call(a,{type:t},T)})};l(n,i),l(o,i),l(s,i)}}}]),r}(),Nt=sa;var He=W(G()),ua=function(){"use strict";function r(e){var t=this;D(this,r),u(this,"_playbackHeartbeatInterval",void 0),u(this,"_playheadShouldBeProgressing",void 0),u(this,"pm",void 0),this.pm=e,this._playbackHeartbeatInterval=null,this._playheadShouldBeProgressing=!1,e.on("playing",function(){t._playheadShouldBeProgressing=!0}),e.on("play",this._startPlaybackHeartbeatInterval.bind(this)),e.on("playing",this._startPlaybackHeartbeatInterval.bind(this)),e.on("adbreakstart",this._startPlaybackHeartbeatInterval.bind(this)),e.on("adplay",this._startPlaybackHeartbeatInterval.bind(this)),e.on("adplaying",this._startPlaybackHeartbeatInterval.bind(this)),e.on("devicewake",this._startPlaybackHeartbeatInterval.bind(this)),e.on("viewstart",this._startPlaybackHeartbeatInterval.bind(this)),e.on("rebufferstart",this._startPlaybackHeartbeatInterval.bind(this)),e.on("pause",this._stopPlaybackHeartbeatInterval.bind(this)),e.on("ended",this._stopPlaybackHeartbeatInterval.bind(this)),e.on("viewend",this._stopPlaybackHeartbeatInterval.bind(this)),e.on("error",this._stopPlaybackHeartbeatInterval.bind(this)),e.on("aderror",this._stopPlaybackHeartbeatInterval.bind(this)),e.on("adpause",this._stopPlaybackHeartbeatInterval.bind(this)),e.on("adended",this._stopPlaybackHeartbeatInterval.bind(this)),e.on("adbreakend",this._stopPlaybackHeartbeatInterval.bind(this)),e.on("seeked",function(){e.data.player_is_paused?t._stopPlaybackHeartbeatInterval():t._startPlaybackHeartbeatInterval()}),e.on("timeupdate",function(){t._playbackHeartbeatInterval!==null&&e.emit("playbackheartbeat")}),e.on("devicesleep",function(i,a){t._playbackHeartbeatInterval!==null&&(He.default.clearInterval(t._playbackHeartbeatInterval),e.emit("playbackheartbeatend",{viewer_time:a.viewer_time}),t._playbackHeartbeatInterval=null)})}return L(r,[{key:"_startPlaybackHeartbeatInterval",value:function(){var t=this;this._playbackHeartbeatInterval===null&&(this.pm.emit("playbackheartbeat"),this._playbackHeartbeatInterval=He.default.setInterval(function(){t.pm.emit("playbackheartbeat")},this.pm.playbackHeartbeatTime))}},{key:"_stopPlaybackHeartbeatInterval",value:function(){this._playheadShouldBeProgressing=!1,this._playbackHeartbeatInterval!==null&&(He.default.clearInterval(this._playbackHeartbeatInterval),this.pm.emit("playbackheartbeatend"),this._playbackHeartbeatInterval=null)}}]),r}(),Pt=ua;var da=function r(e){"use strict";var t=this;D(this,r),u(this,"viewErrored",void 0),e.on("viewinit",function(){t.viewErrored=!1}),e.on("error",function(i,a){try{var n=e.errorTranslator({player_error_code:a.player_error_code,player_error_message:a.player_error_message,player_error_context:a.player_error_context,player_error_severity:a.player_error_severity,player_error_business_exception:a.player_error_business_exception});n&&(e.data.player_error_code=n.player_error_code||a.player_error_code,e.data.player_error_message=n.player_error_message||a.player_error_message,e.data.player_error_context=n.player_error_context||a.player_error_context,e.data.player_error_severity=n.player_error_severity||a.player_error_severity,e.data.player_error_business_exception=n.player_error_business_exception||a.player_error_business_exception,t.viewErrored=!0)}catch(o){e.mux.log.warn("Exception in error translator callback.",o),t.viewErrored=!0}}),e.on("aftererror",function(){var i,a,n,o,s;(i=e.data)===null||i===void 0||delete i.player_error_code,(a=e.data)===null||a===void 0||delete a.player_error_message,(n=e.data)===null||n===void 0||delete n.player_error_context,(o=e.data)===null||o===void 0||delete o.player_error_severity,(s=e.data)===null||s===void 0||delete s.player_error_business_exception})},Lt=da;var la=function(){"use strict";function r(e){D(this,r),u(this,"_watchTimeTrackerLastCheckedTime",void 0),u(this,"pm",void 0),this.pm=e,this._watchTimeTrackerLastCheckedTime=null,e.on("playbackheartbeat",this._updateWatchTime.bind(this)),e.on("playbackheartbeatend",this._clearWatchTimeState.bind(this))}return L(r,[{key:"_updateWatchTime",value:function(t,i){var a=i.viewer_time;this._watchTimeTrackerLastCheckedTime===null&&(this._watchTimeTrackerLastCheckedTime=a),O(this.pm.data,"view_watch_time",a-this._watchTimeTrackerLastCheckedTime),this._watchTimeTrackerLastCheckedTime=a}},{key:"_clearWatchTimeState",value:function(t,i){this._updateWatchTime(t,i),this._watchTimeTrackerLastCheckedTime=null}}]),r}(),Ct=la;var ca=function(){"use strict";function r(e){var t=this;D(this,r),u(this,"_playbackTimeTrackerLastPlayheadPosition",void 0),u(this,"_lastTime",void 0),u(this,"_isAdPlaying",void 0),u(this,"_callbackUpdatePlaybackTime",void 0),u(this,"pm",void 0),this.pm=e,this._playbackTimeTrackerLastPlayheadPosition=-1,this._lastTime=A.now(),this._isAdPlaying=!1,this._callbackUpdatePlaybackTime=null;var i=this._startPlaybackTimeTracking.bind(this);e.on("playing",i),e.on("adplaying",i),e.on("seeked",i);var a=this._stopPlaybackTimeTracking.bind(this);e.on("playbackheartbeatend",a),e.on("seeking",a),e.on("adplaying",function(){t._isAdPlaying=!0}),e.on("adended",function(){t._isAdPlaying=!1}),e.on("adpause",function(){t._isAdPlaying=!1}),e.on("adbreakstart",function(){t._isAdPlaying=!1}),e.on("adbreakend",function(){t._isAdPlaying=!1}),e.on("adplay",function(){t._isAdPlaying=!1}),e.on("viewinit",function(){t._playbackTimeTrackerLastPlayheadPosition=-1,t._lastTime=A.now(),t._isAdPlaying=!1,t._callbackUpdatePlaybackTime=null})}return L(r,[{key:"_startPlaybackTimeTracking",value:function(){this._callbackUpdatePlaybackTime===null&&(this._callbackUpdatePlaybackTime=this._updatePlaybackTime.bind(this),this._playbackTimeTrackerLastPlayheadPosition=this.pm.data.player_playhead_time,this.pm.on("playbackheartbeat",this._callbackUpdatePlaybackTime))}},{key:"_stopPlaybackTimeTracking",value:function(){this._callbackUpdatePlaybackTime&&(this._updatePlaybackTime(),this.pm.off("playbackheartbeat",this._callbackUpdatePlaybackTime),this._callbackUpdatePlaybackTime=null,this._playbackTimeTrackerLastPlayheadPosition=-1)}},{key:"_updatePlaybackTime",value:function(){var t=this.pm.data.player_playhead_time,i=A.now(),a=-1;this._playbackTimeTrackerLastPlayheadPosition>=0&&t>this._playbackTimeTrackerLastPlayheadPosition?a=t-this._playbackTimeTrackerLastPlayheadPosition:this._isAdPlaying&&(a=i-this._lastTime),a>0&&a<=1e3&&O(this.pm.data,"view_content_playback_time",a),this._playbackTimeTrackerLastPlayheadPosition=t,this._lastTime=i}}]),r}(),Mt=ca;var _a=function(){"use strict";function r(e){D(this,r),u(this,"pm",void 0),this.pm=e;var t=this._updatePlayheadTime.bind(this);e.on("playbackheartbeat",t),e.on("playbackheartbeatend",t),e.on("timeupdate",t),e.on("destroy",function(){e.off("timeupdate",t)})}return L(r,[{key:"_updateMaxPlayheadPosition",value:function(){this.pm.data.view_max_playhead_position=typeof this.pm.data.view_max_playhead_position=="undefined"?this.pm.data.player_playhead_time:Math.max(this.pm.data.view_max_playhead_position,this.pm.data.player_playhead_time)}},{key:"_updatePlayheadTime",value:function(t,i){var a=this,n=function(){a.pm.currentFragmentPDT&&a.pm.currentFragmentStart&&(a.pm.data.player_program_time=a.pm.currentFragmentPDT+a.pm.data.player_playhead_time-a.pm.currentFragmentStart)};if(i&&i.player_playhead_time)this.pm.data.player_playhead_time=i.player_playhead_time,n(),this._updateMaxPlayheadPosition();else if(this.pm.getPlayheadTime){var o=this.pm.getPlayheadTime();typeof o!="undefined"&&(this.pm.data.player_playhead_time=o,n(),this._updateMaxPlayheadPosition())}}}]),r}(),Ht=_a;var Bt=5*60*1e3,fa=function r(e){"use strict";if(D(this,r),!e.disableRebufferTracking){var t,i=function(n,o){a(o),t=void 0},a=function(n){if(t){var o=n.viewer_time-t;O(e.data,"view_rebuffer_duration",o),t=n.viewer_time,e.data.view_rebuffer_duration>Bt&&(e.emit("viewend"),e.send("viewend"),e.mux.log.warn("Ending view after rebuffering for longer than ".concat(Bt,"ms, future events will be ignored unless a programchange or videochange occurs.")))}e.data.view_watch_time>=0&&e.data.view_rebuffer_count>0&&(e.data.view_rebuffer_frequency=e.data.view_rebuffer_count/e.data.view_watch_time,e.data.view_rebuffer_percentage=e.data.view_rebuffer_duration/e.data.view_watch_time)};e.on("playbackheartbeat",function(n,o){return a(o)}),e.on("rebufferstart",function(n,o){t||(O(e.data,"view_rebuffer_count",1),t=o.viewer_time,e.one("rebufferend",i))}),e.on("viewinit",function(){t=void 0,e.off("rebufferend",i)})}},Ut=fa;var pa=function(){"use strict";function r(e){var t=this;D(this,r),u(this,"_lastCheckedTime",void 0),u(this,"_lastPlayheadTime",void 0),u(this,"_lastPlayheadTimeUpdatedTime",void 0),u(this,"_rebuffering",void 0),u(this,"pm",void 0),this.pm=e,!(e.disableRebufferTracking||e.disablePlayheadRebufferTracking)&&(this._lastCheckedTime=null,this._lastPlayheadTime=null,this._lastPlayheadTimeUpdatedTime=null,e.on("playbackheartbeat",this._checkIfRebuffering.bind(this)),e.on("playbackheartbeatend",this._cleanupRebufferTracker.bind(this)),e.on("seeking",function(){t._cleanupRebufferTracker(null,{viewer_time:A.now()})}))}return L(r,[{key:"_checkIfRebuffering",value:function(t,i){if(this.pm.seekingTracker.isSeeking||this.pm.adTracker.isAdBreak||!this.pm.playbackHeartbeat._playheadShouldBeProgressing){this._cleanupRebufferTracker(t,i);return}if(this._lastCheckedTime===null){this._prepareRebufferTrackerState(i.viewer_time);return}if(this._lastPlayheadTime!==this.pm.data.player_playhead_time){this._cleanupRebufferTracker(t,i,!0);return}var a=i.viewer_time-this._lastPlayheadTimeUpdatedTime;typeof this.pm.sustainedRebufferThreshold=="number"&&a>=this.pm.sustainedRebufferThreshold&&(this._rebuffering||(this._rebuffering=!0,this.pm.emit("rebufferstart",{viewer_time:this._lastPlayheadTimeUpdatedTime}))),this._lastCheckedTime=i.viewer_time}},{key:"_clearRebufferTrackerState",value:function(){this._lastCheckedTime=null,this._lastPlayheadTime=null,this._lastPlayheadTimeUpdatedTime=null}},{key:"_prepareRebufferTrackerState",value:function(t){this._lastCheckedTime=t,this._lastPlayheadTime=this.pm.data.player_playhead_time,this._lastPlayheadTimeUpdatedTime=t}},{key:"_cleanupRebufferTracker",value:function(t,i){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(this._rebuffering)this._rebuffering=!1,this.pm.emit("rebufferend",{viewer_time:i.viewer_time});else{if(this._lastCheckedTime===null)return;var n=this.pm.data.player_playhead_time-this._lastPlayheadTime,o=i.viewer_time-this._lastPlayheadTimeUpdatedTime;typeof this.pm.minimumRebufferDuration=="number"&&n>0&&o-n>this.pm.minimumRebufferDuration&&(this._lastCheckedTime=null,this.pm.emit("rebufferstart",{viewer_time:this._lastPlayheadTimeUpdatedTime}),this.pm.emit("rebufferend",{viewer_time:this._lastPlayheadTimeUpdatedTime+o-n}))}a?this._prepareRebufferTrackerState(i.viewer_time):this._clearRebufferTrackerState()}}]),r}(),Ft=pa;var va=function(){"use strict";function r(e){var t=this;D(this,r),u(this,"NAVIGATION_START",void 0),u(this,"pm",void 0),this.pm=e,e.on("viewinit",function(){var i=e.data,a=i.view_id;if(!i.view_program_changed){var n=function(o,s){var l=s.viewer_time;o.type==="playing"&&typeof e.data.view_time_to_first_frame=="undefined"?t.calculateTimeToFirstFrame(l||A.now(),a):o.type==="adplaying"&&(typeof e.data.view_time_to_first_frame=="undefined"||t._inPrerollPosition())&&t.calculateTimeToFirstFrame(l||A.now(),a)};e.one("playing",n),e.one("adplaying",n),e.one("viewend",function(){e.off("playing",n),e.off("adplaying",n)})}})}return L(r,[{key:"_inPrerollPosition",value:function(){return typeof this.pm.data.view_content_playback_time=="undefined"||this.pm.data.view_content_playback_time<=1e3}},{key:"calculateTimeToFirstFrame",value:function(t,i){i===this.pm.data.view_id&&(this.pm.watchTimeTracker._updateWatchTime(null,{viewer_time:t}),this.pm.data.view_time_to_first_frame=this.pm.data.view_watch_time,(this.pm.data.player_autoplay_on||this.pm.data.video_is_autoplay)&&this.NAVIGATION_START&&(this.pm.data.view_aggregate_startup_time=this.pm.data.view_start+this.pm.data.view_watch_time-this.NAVIGATION_START))}}]),r}(),Vt=va;var ma=function r(e){"use strict";var t=this;D(this,r),u(this,"_lastPlayerHeight",void 0),u(this,"_lastPlayerWidth",void 0),u(this,"_lastPlayheadPosition",void 0),u(this,"_lastSourceHeight",void 0),u(this,"_lastSourceWidth",void 0),e.on("viewinit",function(){t._lastPlayheadPosition=-1});var i=["pause","rebufferstart","seeking","error","adbreakstart","hb"],a=["playing","hb"];i.forEach(function(n){e.on(n,function(){if(t._lastPlayheadPosition>=0&&e.data.player_playhead_time>=0&&t._lastPlayerWidth>=0&&t._lastSourceWidth>0&&t._lastPlayerHeight>=0&&t._lastSourceHeight>0){var o=e.data.player_playhead_time-t._lastPlayheadPosition;if(o<0){t._lastPlayheadPosition=-1;return}var s=Math.min(t._lastPlayerWidth/t._lastSourceWidth,t._lastPlayerHeight/t._lastSourceHeight),l=Math.max(0,s-1),v=Math.max(0,1-s);e.data.view_max_upscale_percentage=Math.max(e.data.view_max_upscale_percentage||0,l),e.data.view_max_downscale_percentage=Math.max(e.data.view_max_downscale_percentage||0,v),O(e.data,"view_total_content_playback_time",o),O(e.data,"view_total_upscaling",l*o),O(e.data,"view_total_downscaling",v*o)}t._lastPlayheadPosition=-1})}),a.forEach(function(n){e.on(n,function(){t._lastPlayheadPosition=e.data.player_playhead_time,t._lastPlayerWidth=e.data.player_width,t._lastPlayerHeight=e.data.player_height,t._lastSourceWidth=e.data.video_source_width,t._lastSourceHeight=e.data.video_source_height})})},jt=ma;var ha=2e3,ya=function r(e){"use strict";var t=this;D(this,r),u(this,"isSeeking",void 0),this.isSeeking=!1;var i=-1,a=function(){var n=A.now(),o=(e.data.viewer_time||n)-(i||n);O(e.data,"view_seek_duration",o),e.data.view_max_seek_time=Math.max(e.data.view_max_seek_time||0,o),t.isSeeking=!1,i=-1};e.on("seeking",function(n,o){if(Object.assign(e.data,o),t.isSeeking&&o.viewer_time-i<=ha){i=o.viewer_time;return}t.isSeeking&&a(),t.isSeeking=!0,i=o.viewer_time,O(e.data,"view_seek_count",1),e.send("seeking")}),e.on("seeked",function(){a()}),e.on("viewend",function(){t.isSeeking&&(a(),e.send("seeked")),t.isSeeking=!1,i=-1})},Wt=ya;var Gt=function(e,t){e.push(t),e.sort(function(i,a){return i.viewer_time-a.viewer_time})},ga=["adbreakstart","adrequest","adresponse","adplay","adplaying","adpause","adended","adbreakend","aderror","adclicked","adskipped"],ba=function(){"use strict";function r(e){var t=this;D(this,r),u(this,"_adHasPlayed",void 0),u(this,"_adRequests",void 0),u(this,"_adResponses",void 0),u(this,"_currentAdRequestNumber",void 0),u(this,"_currentAdResponseNumber",void 0),u(this,"_prerollPlayTime",void 0),u(this,"_wouldBeNewAdPlay",void 0),u(this,"isAdBreak",void 0),u(this,"pm",void 0),this.pm=e,e.on("viewinit",function(){t.isAdBreak=!1,t._currentAdRequestNumber=0,t._currentAdResponseNumber=0,t._adRequests=[],t._adResponses=[],t._adHasPlayed=!1,t._wouldBeNewAdPlay=!0,t._prerollPlayTime=void 0}),ga.forEach(function(a){return e.on(a,t._updateAdData.bind(t))});var i=function(){t.isAdBreak=!1};e.on("adbreakstart",function(){t.isAdBreak=!0}),e.on("play",i),e.on("playing",i),e.on("viewend",i),e.on("adrequest",function(a,n){n=Object.assign({ad_request_id:"generatedAdRequestId"+t._currentAdRequestNumber++},n),Gt(t._adRequests,n),O(e.data,"view_ad_request_count"),t.inPrerollPosition()&&(e.data.view_preroll_requested=!0,t._adHasPlayed||O(e.data,"view_preroll_request_count"))}),e.on("adresponse",function(a,n){n=Object.assign({ad_request_id:"generatedAdRequestId"+t._currentAdResponseNumber++},n),Gt(t._adResponses,n);var o=t.findAdRequest(n.ad_request_id);o&&O(e.data,"view_ad_request_time",Math.max(0,n.viewer_time-o.viewer_time))}),e.on("adplay",function(a,n){t._adHasPlayed=!0,t._wouldBeNewAdPlay&&(t._wouldBeNewAdPlay=!1,O(e.data,"view_ad_played_count")),t.inPrerollPosition()&&!e.data.view_preroll_played&&(e.data.view_preroll_played=!0,t._adRequests.length>0&&(e.data.view_preroll_request_time=Math.max(0,n.viewer_time-t._adRequests[0].viewer_time)),e.data.view_start&&(e.data.view_startup_preroll_request_time=Math.max(0,n.viewer_time-e.data.view_start)),t._prerollPlayTime=n.viewer_time)}),e.on("adplaying",function(a,n){t.inPrerollPosition()&&typeof e.data.view_preroll_load_time=="undefined"&&typeof t._prerollPlayTime!="undefined"&&(e.data.view_preroll_load_time=n.viewer_time-t._prerollPlayTime,e.data.view_startup_preroll_load_time=n.viewer_time-t._prerollPlayTime)}),e.on("adclicked",function(a,n){t._wouldBeNewAdPlay||O(e.data,"view_ad_clicked_count")}),e.on("adskipped",function(a,n){t._wouldBeNewAdPlay||O(e.data,"view_ad_skipped_count")}),e.on("adended",function(){t._wouldBeNewAdPlay=!0}),e.on("aderror",function(){t._wouldBeNewAdPlay=!0})}return L(r,[{key:"inPrerollPosition",value:function(){return typeof this.pm.data.view_content_playback_time=="undefined"||this.pm.data.view_content_playback_time<=1e3}},{key:"findAdRequest",value:function(t){for(var i=0;i<this._adRequests.length;i++)if(this._adRequests[i].ad_request_id===t)return this._adRequests[i]}},{key:"_updateAdData",value:function(t,i){if(this.inPrerollPosition()){if(!this.pm.data.view_preroll_ad_tag_hostname&&i.ad_tag_url){var a=M(te(i.ad_tag_url),2),n=a[0],o=a[1];this.pm.data.view_preroll_ad_tag_domain=o,this.pm.data.view_preroll_ad_tag_hostname=n}if(!this.pm.data.view_preroll_ad_asset_hostname&&i.ad_asset_url){var s=M(te(i.ad_asset_url),2),l=s[0],v=s[1];this.pm.data.view_preroll_ad_asset_domain=v,this.pm.data.view_preroll_ad_asset_hostname=l}}this.pm.data.ad_asset_url=i==null?void 0:i.ad_asset_url,this.pm.data.ad_tag_url=i==null?void 0:i.ad_tag_url,this.pm.data.ad_creative_id=i==null?void 0:i.ad_creative_id,this.pm.data.ad_id=i==null?void 0:i.ad_id,this.pm.data.ad_universal_id=i==null?void 0:i.ad_universal_id}}]),r}(),Jt=ba;var Ge=W(G());var Ta=function r(e){"use strict";D(this,r);var t,i,a=function(){e.disableRebufferTracking||(O(e.data,"view_waiting_rebuffer_count",1),t=A.now(),i=Ge.default.setInterval(function(){if(t){var v=A.now();O(e.data,"view_waiting_rebuffer_duration",v-t),t=v}},250))},n=function(){e.disableRebufferTracking||t&&(O(e.data,"view_waiting_rebuffer_duration",A.now()-t),t=!1,Ge.default.clearInterval(i))},o=!1,s=function(){o=!0},l=function(){o=!1,n()};e.on("waiting",function(){o&&a()}),e.on("playing",function(){n(),s()}),e.on("pause",l),e.on("seeking",l)},Qt=Ta;var wa=function r(e){"use strict";var t=this;D(this,r),u(this,"lastWallClockTime",void 0);var i=function(){t.lastWallClockTime=A.now(),e.on("before*",a)},a=function(n){var o=A.now(),s=t.lastWallClockTime;t.lastWallClockTime=o,o-s>3e4&&(e.emit("devicesleep",{viewer_time:s}),Object.assign(e.data,{viewer_time:s}),e.send("devicesleep"),e.emit("devicewake",{viewer_time:o}),Object.assign(e.data,{viewer_time:o}),e.send("devicewake"))};e.one("playbackheartbeat",i),e.on("playbackheartbeatend",function(){e.off("before*",a),e.one("playbackheartbeat",i)})},zt=wa;var Be=W(G());var Je=function(r){return r()}(function(){var r=function(){for(var i=0,a={};i<arguments.length;i++){var n=arguments[i];for(var o in n)a[o]=n[o]}return a};function e(t){function i(a,n,o){var s;if(typeof document!="undefined"){if(arguments.length>1){if(o=r({path:"/"},i.defaults,o),typeof o.expires=="number"){var l=new Date;l.setMilliseconds(l.getMilliseconds()+o.expires*864e5),o.expires=l}try{s=JSON.stringify(n),/^[\{\[]/.test(s)&&(n=s)}catch(k){}return t.write?n=t.write(n,a):n=encodeURIComponent(String(n)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),a=encodeURIComponent(String(a)),a=a.replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent),a=a.replace(/[\(\)]/g,escape),document.cookie=[a,"=",n,o.expires?"; expires="+o.expires.toUTCString():"",o.path?"; path="+o.path:"",o.domain?"; domain="+o.domain:"",o.secure?"; secure":""].join("")}a||(s={});for(var v=document.cookie?document.cookie.split("; "):[],T=/(%[0-9A-Z]{2})+/g,b=0;b<v.length;b++){var m=v[b].split("="),_=m.slice(1).join("=");_.charAt(0)==='"'&&(_=_.slice(1,-1));try{var h=m[0].replace(T,decodeURIComponent);if(_=t.read?t.read(_,h):t(_,h)||_.replace(T,decodeURIComponent),this.json)try{_=JSON.parse(_)}catch(k){}if(a===h){s=_;break}a||(s[h]=_)}catch(k){}}return s}}return i.set=i,i.get=function(a){return i.call(i,a)},i.getJSON=function(){return i.apply({json:!0},[].slice.call(arguments))},i.defaults={},i.remove=function(a,n){i(a,"",r(n,{expires:-1}))},i.withConverter=e,i}return e(function(){})});var Kt="muxData",Ea=function(r){return Object.entries(r).map(function(e){var t=M(e,2),i=t[0],a=t[1];return"".concat(i,"=").concat(a)}).join("&")},ka=function(r){return r.split("&").reduce(function(e,t){var i=M(t.split("="),2),a=i[0],n=i[1],o=+n,s=n&&o==n?o:n;return e[a]=s,e},{})},Yt=function(){var e;try{e=ka(Je.get(Kt)||"")}catch(t){e={}}return e},Xt=function(e){try{Je.set(Kt,Ea(e),{expires:365})}catch(t){}},$t=function(){var e=Yt();return e.mux_viewer_id=e.mux_viewer_id||Z(),e.msn=e.msn||Math.random(),Xt(e),{mux_viewer_id:e.mux_viewer_id,mux_sample_number:e.msn}},Zt=function(){var e=Yt(),t=A.now();return e.session_start&&(e.sst=e.session_start,delete e.session_start),e.session_id&&(e.sid=e.session_id,delete e.session_id),e.session_expires&&(e.sex=e.session_expires,delete e.session_expires),(!e.sex||e.sex<t)&&(e.sid=Z(),e.sst=t),e.sex=t+25*60*1e3,Xt(e),{session_id:e.sid,session_start:e.sst,session_expires:e.sex}};function Qe(r,e){var t=e.beaconCollectionDomain,i=e.beaconDomain;if(t)return"https://"+t;r=r||"inferred";var a=i||"litix.io";return r.match(/^[a-z0-9]+$/)?"https://"+r+"."+a:"https://img.litix.io/a.gif"}var er=W(G()),tr=function(){var e;switch(rr()){case"cellular":e="cellular";break;case"ethernet":e="wired";break;case"wifi":e="wifi";break;case void 0:break;default:e="other"}return e},rr=function(){var e=er.default.navigator,t=e&&(e.connection||e.mozConnection||e.webkitConnection);return t&&t.type};tr.getConnectionFromAPI=rr;var ar=tr;var xa={a:"env",b:"beacon",c:"custom",d:"ad",e:"event",f:"experiment",i:"internal",m:"mux",n:"response",p:"player",q:"request",r:"retry",s:"session",t:"timestamp",u:"viewer",v:"video",w:"page",x:"view",y:"sub"},Da=nr(xa),Sa={ad:"ad",ag:"aggregate",ap:"api",al:"application",ar:"architecture",as:"asset",au:"autoplay",av:"average",bi:"bitrate",br:"break",bw:"browser",by:"bytes",bz:"business",ca:"cached",cb:"cancel",cc:"codec",cd:"code",cg:"category",ch:"changed",ck:"clicked",cl:"canceled",cn:"config",co:"count",ce:"counter",cp:"complete",cr:"creative",ct:"content",cu:"current",cx:"connection",cz:"context",dg:"downscaling",dm:"domain",dn:"cdn",do:"downscale",dr:"drm",dp:"dropped",du:"duration",dv:"device",ec:"encoding",ed:"edge",en:"end",eg:"engine",em:"embed",er:"error",ep:"experiments",es:"errorcode",et:"errortext",ee:"event",ev:"events",ex:"expires",ez:"exception",fa:"failed",fi:"first",fm:"family",ft:"format",fp:"fps",fq:"frequency",fr:"frame",fs:"fullscreen",ha:"has",hb:"holdback",he:"headers",ho:"host",hn:"hostname",ht:"height",id:"id",ii:"init",in:"instance",ip:"ip",is:"is",ke:"key",la:"language",lb:"labeled",le:"level",li:"live",ld:"loaded",lo:"load",ls:"lists",lt:"latency",ma:"max",md:"media",me:"message",mf:"manifest",mi:"mime",ml:"midroll",mm:"min",mn:"manufacturer",mo:"model",mx:"mux",ne:"newest",nm:"name",no:"number",on:"on",os:"os",pa:"paused",pb:"playback",pd:"producer",pe:"percentage",pf:"played",pg:"program",ph:"playhead",pi:"plugin",pl:"preroll",pn:"playing",po:"poster",pr:"preload",ps:"position",pt:"part",py:"property",ra:"rate",rd:"requested",re:"rebuffer",rf:"rendition",rm:"remote",ro:"ratio",rp:"response",rq:"request",rs:"requests",sa:"sample",sd:"skipped",se:"session",sk:"seek",sm:"stream",so:"source",sq:"sequence",sr:"series",st:"start",su:"startup",sv:"server",sw:"software",sy:"severity",ta:"tag",tc:"tech",te:"text",tg:"target",th:"throughput",ti:"time",tl:"total",to:"to",tt:"title",ty:"type",ug:"upscaling",un:"universal",up:"upscale",ur:"url",us:"user",va:"variant",vd:"viewed",vi:"video",ve:"version",vw:"view",vr:"viewer",wd:"width",wa:"watch",wt:"waiting"},ir=nr(Sa);function nr(r){var e={};for(var t in r)r.hasOwnProperty(t)&&(e[r[t]]=t);return e}function pe(r){var e={},t={};return Object.keys(r).forEach(function(i){var a=!1;if(r.hasOwnProperty(i)&&r[i]!==void 0){var n=i.split("_"),o=n[0],s=Da[o];s||(q.info("Data key word `"+n[0]+"` not expected in "+i),s=o+"_"),n.splice(1).forEach(function(l){l==="url"&&(a=!0),ir[l]?s+=ir[l]:Number(l)&&Math.floor(Number(l))===Number(l)?s+=l:(q.info("Data key word `"+l+"` not expected in "+i),s+="_"+l+"_")}),a?t[s]=r[i]:e[s]=r[i]}}),Object.assign(e,t)}var re=W(G());var Ra={maxBeaconSize:300,maxQueueLength:3600,baseTimeBetweenBeacons:1e4,maxPayloadKBSize:500},qa=56*1024,Aa=["hb","requestcompleted","requestfailed","requestcanceled"],Oa="https://img.litix.io",X=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this._beaconUrl=e||Oa,this._eventQueue=[],this._postInFlight=!1,this._failureCount=0,this._sendTimeout=!1,this._options=Object.assign({},Ra,t)};X.prototype.queueEvent=function(r,e){var t=Object.assign({},e);return this._eventQueue.length<=this._options.maxQueueLength||r==="eventrateexceeded"?(this._eventQueue.push(t),this._sendTimeout||this._startBeaconSending(),this._eventQueue.length<=this._options.maxQueueLength):!1};X.prototype.flushEvents=function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(r&&this._eventQueue.length===1){this._eventQueue.pop();return}this._eventQueue.length&&this._sendBeaconQueue(),this._startBeaconSending()};X.prototype.destroy=function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.destroyed=!0,r?this._clearBeaconQueue():this.flushEvents(),re.default.clearTimeout(this._sendTimeout)};X.prototype._clearBeaconQueue=function(){var r=this._eventQueue.length>this._options.maxBeaconSize?this._eventQueue.length-this._options.maxBeaconSize:0,e=this._eventQueue.slice(r);r>0&&Object.assign(e[e.length-1],pe({mux_view_message:"event queue truncated"}));var t=this._createPayload(e);or(this._beaconUrl,t,!0,function(){})};X.prototype._sendBeaconQueue=function(){var r=this;if(!this._postInFlight){var e=this._eventQueue.slice(0,this._options.maxBeaconSize);this._eventQueue=this._eventQueue.slice(this._options.maxBeaconSize),this._postInFlight=!0;var t=this._createPayload(e),i=A.now();or(this._beaconUrl,t,!1,function(a,n){n?(r._eventQueue=e.concat(r._eventQueue),r._failureCount+=1,q.info("Error sending beacon: "+n)):r._failureCount=0,r._roundTripTime=A.now()-i,r._postInFlight=!1})}};X.prototype._getNextBeaconTime=function(){if(!this._failureCount)return this._options.baseTimeBetweenBeacons;var r=Math.pow(2,this._failureCount-1);return r=r*Math.random(),(1+r)*this._options.baseTimeBetweenBeacons};X.prototype._startBeaconSending=function(){var r=this;re.default.clearTimeout(this._sendTimeout),!this.destroyed&&(this._sendTimeout=re.default.setTimeout(function(){r._eventQueue.length&&r._sendBeaconQueue(),r._startBeaconSending()},this._getNextBeaconTime()))};X.prototype._createPayload=function(r){var e=this,t={transmission_timestamp:Math.round(A.now())};this._roundTripTime&&(t.rtt_ms=Math.round(this._roundTripTime));var i,a,n,o=function(){i=JSON.stringify({metadata:t,events:a||r}),n=i.length/1024},s=function(){return n<=e._options.maxPayloadKBSize};return o(),s()||(q.info("Payload size is too big ("+n+" kb). Removing unnecessary events."),a=r.filter(function(l){return Aa.indexOf(l.e)===-1}),o()),s()||(q.info("Payload size still too big ("+n+" kb). Cropping fields.."),a.forEach(function(l){for(var v in l){var T=l[v],b=50*1024;typeof T=="string"&&T.length>b&&(l[v]=T.substring(0,b))}}),o()),i};var Ia=function(r){return r.length<=qa},or=function(r,e,t,i){if(t&&navigator&&navigator.sendBeacon&&navigator.sendBeacon(r,e)){i();return}if(re.default.fetch){re.default.fetch(r,{method:"POST",body:e,headers:{"Content-Type":"text/plain"},keepalive:Ia(e)}).then(function(n){return i(null,n.ok?null:"Error")}).catch(function(n){return i(null,n)});return}if(re.default.XMLHttpRequest){var a=new re.default.XMLHttpRequest;a.onreadystatechange=function(){if(a.readyState===4)return i(null,a.status!==200?"error":void 0)},a.open("POST",r),a.setRequestHeader("Content-Type","text/plain"),a.send(e);return}i()},sr=X;var Na=["env_key","view_id","view_sequence_number","player_sequence_number","beacon_domain","player_playhead_time","viewer_time","mux_api_version","event","video_id","player_instance_id","player_error_code","player_error_message","player_error_context","player_error_severity","player_error_business_exception"],Pa=["adplay","adplaying","adpause","adfirstquartile","admidpoint","adthirdquartile","adended","adresponse","adrequest"],La=["ad_id","ad_creative_id","ad_universal_id"],Ca=["viewstart","error","ended","viewend"],Ma=10*60*1e3,ur=function(){"use strict";function r(e,t){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};D(this,r);var a,n,o,s,l,v,T,b,m,_,h,k;u(this,"mux",void 0),u(this,"envKey",void 0),u(this,"options",void 0),u(this,"eventQueue",void 0),u(this,"sampleRate",void 0),u(this,"disableCookies",void 0),u(this,"respectDoNotTrack",void 0),u(this,"previousBeaconData",void 0),u(this,"lastEventTime",void 0),u(this,"rateLimited",void 0),u(this,"pageLevelData",void 0),u(this,"viewerData",void 0),this.mux=e,this.envKey=t,this.options=i,this.previousBeaconData=null,this.lastEventTime=0,this.rateLimited=!1,this.eventQueue=new sr(Qe(this.envKey,this.options));var x;this.sampleRate=(x=this.options.sampleRate)!==null&&x!==void 0?x:1;var p;this.disableCookies=(p=this.options.disableCookies)!==null&&p!==void 0?p:!1;var f;this.respectDoNotTrack=(f=this.options.respectDoNotTrack)!==null&&f!==void 0?f:!1,this.previousBeaconData=null,this.lastEventTime=0,this.rateLimited=!1,this.pageLevelData={mux_api_version:this.mux.API_VERSION,mux_embed:this.mux.NAME,mux_embed_version:this.mux.VERSION,viewer_application_name:(a=this.options.platform)===null||a===void 0?void 0:a.name,viewer_application_version:(n=this.options.platform)===null||n===void 0?void 0:n.version,viewer_application_engine:(o=this.options.platform)===null||o===void 0?void 0:o.layout,viewer_device_name:(s=this.options.platform)===null||s===void 0?void 0:s.product,viewer_device_category:"",viewer_device_manufacturer:(l=this.options.platform)===null||l===void 0?void 0:l.manufacturer,viewer_os_family:(T=this.options.platform)===null||T===void 0||(v=T.os)===null||v===void 0?void 0:v.family,viewer_os_architecture:(m=this.options.platform)===null||m===void 0||(b=m.os)===null||b===void 0?void 0:b.architecture,viewer_os_version:(h=this.options.platform)===null||h===void 0||(_=h.os)===null||_===void 0?void 0:_.version,viewer_connection_type:ar(),page_url:Be.default===null||Be.default===void 0||(k=Be.default.location)===null||k===void 0?void 0:k.href},this.viewerData=this.disableCookies?{}:$t()}return L(r,[{key:"send",value:function(t,i){if(!(!t||!(i!=null&&i.view_id))){if(this.respectDoNotTrack&&de())return q.info("Not sending `"+t+"` because Do Not Track is enabled");if(!i||typeof i!="object")return q.error("A data object was expected in send() but was not provided");var a=this.disableCookies?{}:Zt(),n=_e(oe({},this.pageLevelData,i,a,this.viewerData),{event:t,env_key:this.envKey});n.user_id&&(n.viewer_user_id=n.user_id,delete n.user_id);var o,s=((o=n.mux_sample_number)!==null&&o!==void 0?o:0)>=this.sampleRate,l=this._deduplicateBeaconData(t,n),v=pe(l);if(this.lastEventTime=this.mux.utils.now(),s)return q.info("Not sending event due to sample rate restriction",t,n,v);if(this.envKey||q.info("Missing environment key (envKey) - beacons will be dropped if the video source is not a valid mux video URL",t,n,v),!this.rateLimited){if(q.info("Sending event",t,n,v),this.rateLimited=!this.eventQueue.queueEvent(t,v),this.mux.WINDOW_UNLOADING&&t==="viewend")this.eventQueue.destroy(!0);else if(this.mux.WINDOW_HIDDEN&&t==="hb"?this.eventQueue.flushEvents(!0):Ca.indexOf(t)>=0&&this.eventQueue.flushEvents(),this.rateLimited)return n.event="eventrateexceeded",v=pe(n),this.eventQueue.queueEvent(n.event,v),q.error("Beaconing disabled due to rate limit.")}}}},{key:"destroy",value:function(){this.eventQueue.destroy(!1)}},{key:"_deduplicateBeaconData",value:function(t,i){var a=this,n={},o=i.view_id;if(o==="-1"||t==="viewstart"||t==="viewend"||!this.previousBeaconData||this.mux.utils.now()-this.lastEventTime>=Ma)n=oe({},i),o&&(this.previousBeaconData=n),o&&t==="viewend"&&(this.previousBeaconData=null);else{var s=t.indexOf("request")===0;Object.entries(i).forEach(function(l){var v=M(l,2),T=v[0],b=v[1];a.previousBeaconData&&(b!==a.previousBeaconData[T]||Na.indexOf(T)>-1||a.objectHasChanged(s,T,b,a.previousBeaconData[T])||a.eventRequiresKey(t,T))&&(n[T]=b,a.previousBeaconData[T]=b)})}return n}},{key:"objectHasChanged",value:function(t,i,a,n){return!t||i.indexOf("request_")!==0?!1:i==="request_response_headers"||typeof a!="object"||typeof n!="object"?!0:Object.keys(a||{}).length!==Object.keys(n||{}).length}},{key:"eventRequiresKey",value:function(t,i){return!!(t==="renditionchange"&&i.indexOf("video_source_")===0||La.includes(i)&&Pa.includes(t))}}]),r}();var Ha=function r(e){"use strict";D(this,r);var t=0,i=0,a=0,n=0,o=0,s=0,l=0,v=function(m,_){var h=_.request_start,k=_.request_response_start,x=_.request_response_end,p=_.request_bytes_loaded;n++;var f,c;if(k?(f=k-(h!=null?h:0),c=(x!=null?x:0)-k):c=(x!=null?x:0)-(h!=null?h:0),c>0&&p&&p>0){var d=p/c*8e3;o++,i+=p,a+=c,e.data.view_min_request_throughput=Math.min(e.data.view_min_request_throughput||1/0,d),e.data.view_average_request_throughput=i/a*8e3,e.data.view_request_count=n,f>0&&(t+=f,e.data.view_max_request_latency=Math.max(e.data.view_max_request_latency||0,f),e.data.view_average_request_latency=t/o)}},T=function(m,_){n++,s++,e.data.view_request_count=n,e.data.view_request_failed_count=s},b=function(m,_){n++,l++,e.data.view_request_count=n,e.data.view_request_canceled_count=l};e.on("requestcompleted",v),e.on("requestfailed",T),e.on("requestcanceled",b)},dr=Ha;var Ba=60*60*1e3,Ua=function r(e){"use strict";var t=this;D(this,r),u(this,"_lastEventTime",void 0),e.on("before*",function(i,a){var n=a.viewer_time,o=A.now(),s=t._lastEventTime;if(t._lastEventTime=o,s&&o-s>Ba){var l=Object.keys(e.data).reduce(function(T,b){return b.indexOf("video_")===0?Object.assign(T,u({},b,e.data[b])):T},{});e.mux.log.info("Received event after at least an hour inactivity, creating a new view");var v=e.playbackHeartbeat._playheadShouldBeProgressing;e._resetView(Object.assign({viewer_time:n},l)),e.playbackHeartbeat._playheadShouldBeProgressing=v,e.playbackHeartbeat._playheadShouldBeProgressing&&i.type!=="play"&&i.type!=="adbreakstart"&&(e.emit("play",{viewer_time:n}),i.type!=="playing"&&e.emit("playing",{viewer_time:n}))}})},lr=Ua;var Fa=["viewstart","ended","loadstart","pause","play","playing","ratechange","waiting","adplay","adpause","adended","aderror","adplaying","adrequest","adresponse","adbreakstart","adbreakend","adfirstquartile","admidpoint","adthirdquartile","rebufferstart","rebufferend","seeked","error","hb","requestcompleted","requestfailed","requestcanceled","renditionchange"],Va=new Set(["requestcompleted","requestfailed","requestcanceled"]),ja=function(r){"use strict";wt(t,r);var e=xt(t);function t(i,a,n){D(this,t);var o;o=e.call(this),u(g(o),"DOM_CONTENT_LOADED_EVENT_END",void 0),u(g(o),"NAVIGATION_START",void 0),u(g(o),"_destroyed",void 0),u(g(o),"_heartBeatTimeout",void 0),u(g(o),"adTracker",void 0),u(g(o),"dashjs",void 0),u(g(o),"data",void 0),u(g(o),"disablePlayheadRebufferTracking",void 0),u(g(o),"disableRebufferTracking",void 0),u(g(o),"errorTracker",void 0),u(g(o),"errorTranslator",void 0),u(g(o),"getAdData",void 0),u(g(o),"getPlayheadTime",void 0),u(g(o),"getStateData",void 0),u(g(o),"hlsjs",void 0),u(g(o),"id",void 0),u(g(o),"longResumeTracker",void 0),u(g(o),"minimumRebufferDuration",void 0),u(g(o),"mux",void 0),u(g(o),"oldEmit",void 0),u(g(o),"playbackEventDispatcher",void 0),u(g(o),"playbackHeartbeat",void 0),u(g(o),"playbackHeartbeatTime",void 0),u(g(o),"playheadTime",void 0),u(g(o),"seekingTracker",void 0),u(g(o),"sustainedRebufferThreshold",void 0),u(g(o),"watchTimeTracker",void 0),u(g(o),"currentFragmentPDT",void 0),u(g(o),"currentFragmentStart",void 0),o.DOM_CONTENT_LOADED_EVENT_END=ce.domContentLoadedEventEnd(),o.NAVIGATION_START=ce.navigationStart();var s={debug:!1,minimumRebufferDuration:250,sustainedRebufferThreshold:1e3,playbackHeartbeatTime:25,beaconDomain:"litix.io",sampleRate:1,disableCookies:!1,respectDoNotTrack:!1,disableRebufferTracking:!1,disablePlayheadRebufferTracking:!1,errorTranslator:function(m){return m}};o.mux=i,o.id=a,n!=null&&n.beaconDomain&&o.mux.log.warn("The `beaconDomain` setting has been deprecated in favor of `beaconCollectionDomain`. Please change your integration to use `beaconCollectionDomain` instead of `beaconDomain`."),n=Object.assign(s,n),n.data=n.data||{},n.data.property_key&&(n.data.env_key=n.data.property_key,delete n.data.property_key),q.level=n.debug?Y.DEBUG:Y.WARN,o.getPlayheadTime=n.getPlayheadTime,o.getStateData=n.getStateData||function(){return{}},o.getAdData=n.getAdData||function(){},o.minimumRebufferDuration=n.minimumRebufferDuration,o.sustainedRebufferThreshold=n.sustainedRebufferThreshold,o.playbackHeartbeatTime=n.playbackHeartbeatTime,o.disableRebufferTracking=n.disableRebufferTracking,o.disableRebufferTracking&&o.mux.log.warn("Disabling rebuffer tracking. This should only be used in specific circumstances as a last resort when your player is known to unreliably track rebuffering."),o.disablePlayheadRebufferTracking=n.disablePlayheadRebufferTracking,o.errorTranslator=n.errorTranslator,o.playbackEventDispatcher=new ur(i,n.data.env_key,n),o.data={player_instance_id:Z(),mux_sample_rate:n.sampleRate,beacon_domain:n.beaconCollectionDomain||n.beaconDomain},o.data.view_sequence_number=1,o.data.player_sequence_number=1,o.oldEmit=o.emit,o.emit=function(m,_){_=Object.assign({viewer_time:this.mux.utils.now()},_),this.oldEmit(m,_)};var l=function(){typeof this.data.view_start=="undefined"&&(this.data.view_start=this.mux.utils.now(),this.emit("viewstart"))}.bind(g(o));if(o.on("viewinit",function(m,_){this._resetVideoData(),this._resetViewData(),this._resetErrorData(),this._updateStateData(),Object.assign(this.data,_),this._initializeViewData(),this.one("play",l),this.one("adbreakstart",l)}),o.on("videochange",function(m,_){this._resetView(_)}),o.on("programchange",function(m,_){this.data.player_is_paused&&this.mux.log.warn("The `programchange` event is intended to be used when the content changes mid playback without the video source changing, however the video is not currently playing. If the video source is changing please use the videochange event otherwise you will lose startup time information."),this._resetView(Object.assign(_,{view_program_changed:!0})),l(),this.emit("play"),this.emit("playing")}),o.on("fragmentchange",function(m,_){this.currentFragmentPDT=_.currentFragmentPDT,this.currentFragmentStart=_.currentFragmentStart}),o.on("destroy",o.destroy),typeof window!="undefined"&&typeof window.addEventListener=="function"&&typeof window.removeEventListener=="function"){var v=function(){var m=typeof o.data.view_start!="undefined";o.mux.WINDOW_HIDDEN=document.visibilityState==="hidden",m&&o.mux.WINDOW_HIDDEN&&(o.data.player_is_paused||o.emit("hb"))};window.addEventListener("visibilitychange",v,!1);var T=function(m){m.persisted||o.destroy()};window.addEventListener("pagehide",T,!1),o.on("destroy",function(){window.removeEventListener("visibilitychange",v),window.removeEventListener("pagehide",T)})}o.on("playerready",function(m,_){Object.assign(this.data,_)}),Fa.forEach(function(m){o.on(m,function(_,h){m.indexOf("ad")!==0&&this._updateStateData(),Object.assign(this.data,h),this._sanitizeData()}),o.on("after"+m,function(){(m!=="error"||this.errorTracker.viewErrored)&&this.send(m)})}),o.on("viewend",function(m,_){Object.assign(o.data,_)});var b=function(_){var h=this.mux.utils.now();this.data.player_init_time&&(this.data.player_startup_time=h-this.data.player_init_time),!this.mux.PLAYER_TRACKED&&this.NAVIGATION_START&&(this.mux.PLAYER_TRACKED=!0,(this.data.player_init_time||this.DOM_CONTENT_LOADED_EVENT_END)&&(this.data.page_load_time=Math.min(this.data.player_init_time||1/0,this.DOM_CONTENT_LOADED_EVENT_END||1/0)-this.NAVIGATION_START)),this.send("playerready"),delete this.data.player_startup_time,delete this.data.page_load_time};return o.one("playerready",b),o.longResumeTracker=new lr(g(o)),o.errorTracker=new Lt(g(o)),new zt(g(o)),o.seekingTracker=new Wt(g(o)),o.playheadTime=new Ht(g(o)),o.playbackHeartbeat=new Pt(g(o)),new jt(g(o)),o.watchTimeTracker=new Ct(g(o)),new Mt(g(o)),o.adTracker=new Jt(g(o)),new Ft(g(o)),new Ut(g(o)),new Vt(g(o)),new Qt(g(o)),new dr(g(o)),n.hlsjs&&o.addHLSJS(n),n.dashjs&&o.addDashJS(n),o.emit("viewinit",n.data),o}return L(t,[{key:"destroy",value:function(){this._destroyed||(this._destroyed=!0,typeof this.data.view_start!="undefined"&&(this.emit("viewend"),this.send("viewend")),this.playbackEventDispatcher.destroy(),this.removeHLSJS(),this.removeDashJS(),window.clearTimeout(this._heartBeatTimeout))}},{key:"send",value:function(a){if(this.data.view_id){var n=Object.assign({},this.data),o=["player_program_time","player_manifest_newest_program_time","player_live_edge_program_time","player_program_time","video_holdback","video_part_holdback","video_target_duration","video_part_target_duration"];if(n.video_source_is_live===void 0&&(n.player_source_duration===1/0||n.video_source_duration===1/0?n.video_source_is_live=!0:(n.player_source_duration>0||n.video_source_duration>0)&&(n.video_source_is_live=!1)),n.video_source_is_live||o.forEach(function(T){n[T]=void 0}),n.video_source_url=n.video_source_url||n.player_source_url,n.video_source_url){var s=M(te(n.video_source_url),2),l=s[0],v=s[1];n.video_source_domain=v,n.video_source_hostname=l}delete n.ad_request_id,this.playbackEventDispatcher.send(a,n),this.data.view_sequence_number++,this.data.player_sequence_number++,Va.has(a)||this._restartHeartBeat(),a==="viewend"&&delete this.data.view_id}}},{key:"_resetView",value:function(a){this.emit("viewend"),this.send("viewend"),this.emit("viewinit",a)}},{key:"_updateStateData",value:function(){Object.assign(this.data,this.getStateData()),this.playheadTime._updatePlayheadTime(),this._sanitizeData()}},{key:"_sanitizeData",value:function(){var a=this,n=["player_width","player_height","video_source_width","video_source_height","player_playhead_time","video_source_bitrate"];n.forEach(function(s){var l=parseInt(a.data[s],10);a.data[s]=isNaN(l)?void 0:l});var o=["player_source_url","video_source_url"];o.forEach(function(s){if(a.data[s]){var l=a.data[s].toLowerCase();(l.indexOf("data:")===0||l.indexOf("blob:")===0)&&(a.data[s]="MSE style URL")}})}},{key:"_resetVideoData",value:function(){var a=this;Object.keys(this.data).forEach(function(n){n.indexOf("video_")===0&&delete a.data[n]})}},{key:"_resetViewData",value:function(){var a=this;Object.keys(this.data).forEach(function(n){n.indexOf("view_")===0&&delete a.data[n]}),this.data.view_sequence_number=1}},{key:"_resetErrorData",value:function(){delete this.data.player_error_code,delete this.data.player_error_message,delete this.data.player_error_context,delete this.data.player_error_severity,delete this.data.player_error_business_exception}},{key:"_initializeViewData",value:function(){var a=this,n=this.data.view_id=Z(),o=function(){n===a.data.view_id&&O(a.data,"player_view_count",1)};this.data.player_is_paused?this.one("play",o):o()}},{key:"_restartHeartBeat",value:function(){var a=this;window.clearTimeout(this._heartBeatTimeout),this._heartBeatTimeout=window.setTimeout(function(){a.data.player_is_paused||a.emit("hb")},1e4)}},{key:"addHLSJS",value:function(a){if(!a.hlsjs){this.mux.log.warn("You must pass a valid hlsjs instance in order to track it.");return}if(this.hlsjs){this.mux.log.warn("An instance of HLS.js is already being monitored for this player.");return}this.hlsjs=a.hlsjs,St(this.mux,this.id,a.hlsjs,{},a.Hls||window.Hls)}},{key:"removeHLSJS",value:function(){this.hlsjs&&(Rt(this.hlsjs),this.hlsjs=void 0)}},{key:"addDashJS",value:function(a){if(!a.dashjs){this.mux.log.warn("You must pass a valid dashjs instance in order to track it.");return}if(this.dashjs){this.mux.log.warn("An instance of Dash.js is already being monitored for this player.");return}this.dashjs=a.dashjs,At(this.mux,this.id,a.dashjs)}},{key:"removeDashJS",value:function(){this.dashjs&&(Ot(this.dashjs),this.dashjs=void 0)}}]),t}(Nt),cr=ja;Pe();var me=W(Mr());function at(){return me.default&&!!(me.default.fullscreenElement||me.default.webkitFullscreenElement||me.default.mozFullScreenElement||me.default.msFullscreenElement)}var vi=["loadstart","pause","play","playing","seeking","seeked","timeupdate","ratechange","stalled","waiting","error","ended"],mi={1:"MEDIA_ERR_ABORTED",2:"MEDIA_ERR_NETWORK",3:"MEDIA_ERR_DECODE",4:"MEDIA_ERR_SRC_NOT_SUPPORTED"};function it(r,e,t){var i=M(xe(e),3),a=i[0],n=i[1],o=i[2],s=r.log,l=r.utils.getComputedStyle,v=r.utils.secondsToMs,T={automaticErrorTracking:!0};if(a){if(o!=="video"&&o!=="audio")return s.error("The element of `"+n+"` was not a media element.")}else return s.error("No element was found with the `"+n+"` query selector.");a.mux&&(a.mux.destroy(),delete a.mux,s.warn("Already monitoring this video element, replacing existing event listeners")),t=Object.assign(T,t),t.data=Object.assign({player_software:"HTML5 Video Element",player_mux_plugin_name:"VideoElementMonitor",player_mux_plugin_version:r.VERSION},t.data),t.getPlayheadTime=function(){return v(a.currentTime)},t.getStateData=function(){var m,_=this.hlsjs&&this.hlsjs.url,h=this.dashjs&&le(this.dashjs.getSource==="function")&&this.dashjs.getSource(),k={player_is_paused:a.paused,player_playhead_time:v(a.currentTime),player_width:parseInt(l(a,"width")),player_height:parseInt(l(a,"height")),player_autoplay_on:a.autoplay,player_preload_on:a.preload,player_language_code:a.lang,player_is_fullscreen:at(),video_poster_url:a.poster,video_source_url:_||h||a.currentSrc,video_source_duration:v(a.duration),video_source_height:a.videoHeight,video_source_width:a.videoWidth,view_dropped_frame_count:a==null||(m=a.getVideoPlaybackQuality)===null||m===void 0?void 0:m.call(a).droppedVideoFrames},x=t.getPlayheadTime();if(a.getStartDate&&x>0){var p=a.getStartDate();if(p&&typeof p.getTime=="function"&&p.getTime()){var f=p.getTime();if(k.player_program_time=f+x,a.seekable.length>0){var c=f+a.seekable.end(a.seekable.length-1);k.player_live_edge_program_time=c}}}return k},a.mux=a.mux||{},a.mux.deleted=!1,a.mux.emit=function(m,_){r.emit(n,m,_)},a.mux.updateData=function(m){a.mux.emit("hb",m)};var b=function(){s.error("The monitor for this video element has already been destroyed.")};a.mux.destroy=function(){Object.keys(a.mux.listeners).forEach(function(m){a.removeEventListener(m,a.mux.listeners[m],!1)}),delete a.mux.listeners,a.mux.destroy=b,a.mux.swapElement=b,a.mux.emit=b,a.mux.addHLSJS=b,a.mux.addDashJS=b,a.mux.removeHLSJS=b,a.mux.removeDashJS=b,a.mux.updateData=b,a.mux.deleted=!0,r.emit(n,"destroy")},a.mux.swapElement=function(m){var _=M(xe(m),3),h=_[0],k=_[1],x=_[2];if(h){if(x!=="video"&&x!=="audio")return r.log.error("The element of `"+k+"` was not a media element.")}else return r.log.error("No element was found with the `"+k+"` query selector.");h.muxId=a.muxId,delete a.muxId,h.mux=h.mux||{},h.mux.listeners=Object.assign({},a.mux.listeners),delete a.mux.listeners,Object.keys(h.mux.listeners).forEach(function(p){a.removeEventListener(p,h.mux.listeners[p],!1),h.addEventListener(p,h.mux.listeners[p],!1)}),h.mux.swapElement=a.mux.swapElement,h.mux.destroy=a.mux.destroy,delete a.mux,a=h},a.mux.addHLSJS=function(m){r.addHLSJS(n,m)},a.mux.addDashJS=function(m){r.addDashJS(n,m)},a.mux.removeHLSJS=function(){r.removeHLSJS(n)},a.mux.removeDashJS=function(){r.removeDashJS(n)},r.init(n,t),r.emit(n,"playerready"),a.paused||(r.emit(n,"play"),a.readyState>2&&r.emit(n,"playing")),a.mux.listeners={},vi.forEach(function(m){m==="error"&&!t.automaticErrorTracking||(a.mux.listeners[m]=function(){var _={};if(m==="error"){if(!a.error||a.error.code===1)return;_.player_error_code=a.error.code,_.player_error_message=mi[a.error.code]||a.error.message}r.emit(n,m,_)},a.addEventListener(m,a.mux.listeners[m],!1))})}function nt(r,e,t,i){var a=i;if(r&&typeof r[e]=="function")try{a=r[e].apply(r,t)}catch(n){q.info("safeCall error",n)}return a}var ye=W(G()),he;ye.default&&ye.default.WeakMap&&(he=new WeakMap);function ot(r,e){if(!r||!e||!ye.default||typeof ye.default.getComputedStyle!="function")return"";var t;return he&&he.has(r)&&(t=he.get(r)),t||(t=ye.default.getComputedStyle(r,null),he&&he.set(r,t)),t.getPropertyValue(e)}function st(r){return Math.floor(r*1e3)}var ue={TARGET_DURATION:"#EXT-X-TARGETDURATION",PART_INF:"#EXT-X-PART-INF",SERVER_CONTROL:"#EXT-X-SERVER-CONTROL",INF:"#EXTINF",PROGRAM_DATE_TIME:"#EXT-X-PROGRAM-DATE-TIME",VERSION:"#EXT-X-VERSION",SESSION_DATA:"#EXT-X-SESSION-DATA"},Fe=function(e){return this.buffer="",this.manifest={segments:[],serverControl:{},sessionData:{}},this.currentUri={},this.process(e),this.manifest};Fe.prototype.process=function(r){var e;for(this.buffer+=r,e=this.buffer.indexOf("\n");e>-1;e=this.buffer.indexOf("\n"))this.processLine(this.buffer.substring(0,e)),this.buffer=this.buffer.substring(e+1)};Fe.prototype.processLine=function(r){var e=r.indexOf(":"),t=bi(r,e),i=t[0],a=t.length===2?dt(t[1]):void 0;if(i[0]!=="#")this.currentUri.uri=i,this.manifest.segments.push(this.currentUri),this.manifest.targetDuration&&!("duration"in this.currentUri)&&(this.currentUri.duration=this.manifest.targetDuration),this.currentUri={};else switch(i){case ue.TARGET_DURATION:{if(!isFinite(a)||a<0)return;this.manifest.targetDuration=a,this.setHoldBack();break}case ue.PART_INF:{ut(this.manifest,t),this.manifest.partInf.partTarget&&(this.manifest.partTargetDuration=this.manifest.partInf.partTarget),this.setHoldBack();break}case ue.SERVER_CONTROL:{ut(this.manifest,t),this.setHoldBack();break}case ue.INF:{a===0?this.currentUri.duration=.01:a>0&&(this.currentUri.duration=a);break}case ue.PROGRAM_DATE_TIME:{var n=a,o=new Date(n);this.manifest.dateTimeString||(this.manifest.dateTimeString=n,this.manifest.dateTimeObject=o),this.currentUri.dateTimeString=n,this.currentUri.dateTimeObject=o;break}case ue.VERSION:{ut(this.manifest,t);break}case ue.SESSION_DATA:{var s=Ti(t[1]),l=Ce(s);Object.assign(this.manifest.sessionData,l)}}};Fe.prototype.setHoldBack=function(){var r=this.manifest,e=r.serverControl,t=r.targetDuration,i=r.partTargetDuration;if(e){var a="holdBack",n="partHoldBack",o=t&&t*3,s=i&&i*2;t&&!e.hasOwnProperty(a)&&(e[a]=o),o&&e[a]<o&&(e[a]=o),i&&!e.hasOwnProperty(n)&&(e[n]=i*3),i&&e[n]<s&&(e[n]=s)}};var ut=function(r,e){var t=Hr(e[0].replace("#EXT-X-","")),i;gi(e[1])?(i={},i=Object.assign(yi(e[1]),i)):i=dt(e[1]),r[t]=i},Hr=function(r){return r.toLowerCase().replace(/-(\w)/g,function(e){return e[1].toUpperCase()})},dt=function(r){if(r.toLowerCase()==="yes"||r.toLowerCase()==="no")return r.toLowerCase()==="yes";var e=r.indexOf(":")!==-1?r:parseFloat(r);return isNaN(e)?r:e},hi=function(r){var e={},t=r.split("=");if(t.length>1){var i=Hr(t[0]);e[i]=dt(t[1])}return e},yi=function(r){for(var e=r.split(","),t={},i=0;e.length>i;i++){var a=e[i],n=hi(a);t=Object.assign(n,t)}return t},gi=function(r){return r.indexOf("=")>-1},bi=function(r,e){return e===-1?[r]:[r.substring(0,e),r.substring(e+1)]},Ti=function(r){var e={};if(r){var t=r.search(","),i=r.slice(0,t),a=r.slice(t+1),n=[i,a];return n.forEach(function(o,s){for(var l=o.replace(/['"]+/g,"").split("="),v=0;v<l.length;v++)l[v]==="DATA-ID"&&(e["DATA-ID"]=l[1-v]),l[v]==="VALUE"&&(e.VALUE=l[1-v])}),{data:e}}},Br=Fe;var wi={safeCall:nt,safeIncrement:O,getComputedStyle:ot,secondsToMs:st,assign:Object.assign,headersStringToObject:fe,cdnHeadersToRequestId:se,extractHostnameAndDomain:te,extractHostname:U,manifestParser:Br,generateShortID:Oe,generateUUID:Z,now:A.now},Ur=wi;var Ei={PLAYER_READY:"playerready",VIEW_INIT:"viewinit",VIDEO_CHANGE:"videochange",PLAY:"play",PAUSE:"pause",PLAYING:"playing",TIME_UPDATE:"timeupdate",SEEKING:"seeking",SEEKED:"seeked",REBUFFER_START:"rebufferstart",REBUFFER_END:"rebufferend",ERROR:"error",ENDED:"ended",RENDITION_CHANGE:"renditionchange",ORIENTATION_CHANGE:"orientationchange",AD_REQUEST:"adrequest",AD_RESPONSE:"adresponse",AD_BREAK_START:"adbreakstart",AD_PLAY:"adplay",AD_PLAYING:"adplaying",AD_PAUSE:"adpause",AD_FIRST_QUARTILE:"adfirstquartile",AD_MID_POINT:"admidpoint",AD_THIRD_QUARTILE:"adthirdquartile",AD_ENDED:"adended",AD_BREAK_END:"adbreakend",AD_ERROR:"aderror",REQUEST_COMPLETED:"requestcompleted",REQUEST_FAILED:"requestfailed",REQUEST_CANCELLED:"requestcanceled",HEARTBEAT:"hb",DESTROY:"destroy"},Fr=Ei;var ki="mux-embed",xi="5.4.1",Di="2.1",F={},ie=function(e){var t=arguments;typeof e=="string"?ie.hasOwnProperty(e)?ge.default.setTimeout(function(){t=Array.prototype.splice.call(t,1),ie[e].apply(null,t)},0):q.warn("`"+e+"` is an unknown task"):typeof e=="function"?ge.default.setTimeout(function(){e(ie)},0):q.warn("`"+e+"` is invalid.")},Si={loaded:A.now(),NAME:ki,VERSION:xi,API_VERSION:Di,PLAYER_TRACKED:!1,monitor:function(e,t){return it(ie,e,t)},destroyMonitor:function(e){var t=M(xe(e),1),i=t[0];i&&i.mux&&typeof i.mux.destroy=="function"?i.mux.destroy():q.error("A video element monitor for `"+e+"` has not been initialized via `mux.monitor`.")},addHLSJS:function(e,t){var i=K(e);F[i]?F[i].addHLSJS(t):q.error("A monitor for `"+i+"` has not been initialized.")},addDashJS:function(e,t){var i=K(e);F[i]?F[i].addDashJS(t):q.error("A monitor for `"+i+"` has not been initialized.")},removeHLSJS:function(e){var t=K(e);F[t]?F[t].removeHLSJS():q.error("A monitor for `"+t+"` has not been initialized.")},removeDashJS:function(e){var t=K(e);F[t]?F[t].removeDashJS():q.error("A monitor for `"+t+"` has not been initialized.")},init:function(e,t){de()&&t&&t.respectDoNotTrack&&q.info("The browser's Do Not Track flag is enabled - Mux beaconing is disabled.");var i=K(e);F[i]=new cr(ie,i,t)},emit:function(e,t,i){var a=K(e);F[a]?(F[a].emit(t,i),t==="destroy"&&delete F[a]):q.error("A monitor for `"+a+"` has not been initialized.")},updateData:function(e,t){var i=K(e);F[i]?F[i].emit("hb",t):q.error("A monitor for `"+i+"` has not been initialized.")},checkDoNotTrack:de,log:q,utils:Ur,events:Fr,WINDOW_HIDDEN:!1,WINDOW_UNLOADING:!1};Object.assign(ie,Si);typeof ge.default!="undefined"&&typeof ge.default.addEventListener=="function"&&ge.default.addEventListener("pagehide",function(r){r.persisted||(ie.WINDOW_UNLOADING=!0)},!1);var cd=ie;export{cd as default};
/*!
* JavaScript Cookie v2.1.3
* https://github.com/js-cookie/js-cookie
*
* Copyright 2006, 2015 Klaus Hartl & Fagner Brack
* Released under the MIT license
*/
